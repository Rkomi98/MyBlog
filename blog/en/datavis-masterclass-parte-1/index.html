<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Data Visualization Masterclass - Part 1 | Mirko Calcaterra</title>
  <meta name="description" content="üìä Data Visualization masterclass ‚Äî Part 1 &quot;So What?&quot; Framework, Pyramid Principle and the fundamentals of Dataviz Context: This educational notebook was designed for the advanced Data Analysis lesson for Mondadori (March 2026). Dataset: The data has been sim‚Ä¶">
  <meta name="keywords" content="Data Visualization, Notebook, Data Storytelling, Masterclass, Python, Matplotlib, Seaborn, Plotly">
  <meta name="author" content="Mirko Calcaterra">
  <link rel="canonical" href="${pageUrl}">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9EVQ8G9W48"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-9EVQ8G9W48');
  </script>

  <!-- Open Graph -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://rkomi98.github.io/MyBlog/blog/en/datavis-masterclass-parte-1/">
  <meta property="og:title" content="Data Visualization Masterclass - Part 1">
  <meta property="og:description" content="üìä Data Visualization masterclass ‚Äî Part 1 &quot;So What?&quot; Framework, Pyramid Principle and the fundamentals of Dataviz Context: This educational notebook was designed for the advanced Data Analysis lesson for Mondadori (March 2026). Dataset: The data has been sim‚Ä¶">
  <meta property="og:image" content="https://rkomi98.github.io/MyBlog/Assets/Logo.png">
  <meta property="article:published_time" content="2026-02-18T00:00:00.000Z">
  <meta property="article:author" content="Mirko Calcaterra">
  <meta property="article:section" content="AI Engineering Path">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:title" content="Data Visualization Masterclass - Part 1">
  <meta property="twitter:description" content="üìä Data Visualization masterclass ‚Äî Part 1 &quot;So What?&quot; Framework, Pyramid Principle and the fundamentals of Dataviz Context: This educational notebook was designed for the advanced Data Analysis lesson for Mondadori (March 2026). Dataset: The data has been sim‚Ä¶">
  <meta property="twitter:image" content="https://rkomi98.github.io/MyBlog/Assets/Logo.png">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Data Visualization Masterclass - Part 1",
    "image": "https://rkomi98.github.io/MyBlog/Assets/Logo.png",
    "datePublished": "2026-02-18T00:00:00.000Z",
    "dateModified": "2026-02-18T18:11:35.519Z",
    "author": {
      "@type": "Person",
      "name": "Mirko Calcaterra",
      "url": "https://rkomi98.github.io/MyBlog/"
    },
    "publisher": {
      "@type": "Person",
      "name": "Mirko Calcaterra"
    },
    "description": "üìä Data Visualization masterclass ‚Äî Part 1 &quot;So What?&quot; Framework, Pyramid Principle and the fundamentals of Dataviz Context: This educational notebook was designed for the advanced Data Analysis lesson for Mondadori (March 2026). Dataset: The data has been sim‚Ä¶"
  }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      margin: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: radial-gradient(120% 120% at 50% 0%, rgba(59, 130, 246, 0.18) 0%, transparent 65%), var(--bg-primary);
      color: var(--text-primary);
      transition: background 0.3s ease, color 0.3s ease;
      --bg-primary: #0f172a;
      --bg-secondary: #111c33;
      --bg-card: rgba(15, 23, 42, 0.78);
      --bg-card-strong: rgba(15, 23, 42, 0.9);
      --border: rgba(148, 163, 184, 0.24);
      --text-primary: #e2e8f0;
      --text-secondary: #cbd5f5;
      --text-muted: #94a3b8;
      --accent: #60a5fa;
      --accent-strong: #38bdf8;
      --shadow-lg: 0 28px 60px -36px rgba(15, 23, 42, 0.9);
      --code-inline-bg: rgba(6, 11, 19, 0.92);
      --code-block-bg: #050912;
      --code-border: rgba(148, 163, 184, 0.35);
      --code-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.12);
      --code-text: #f8fafc;
    }
    body[data-theme="light"] {
      --bg-primary: #f8fafc;
      --bg-secondary: #ffffff;
      --bg-card: rgba(255, 255, 255, 0.96);
      --bg-card-strong: rgba(248, 250, 252, 0.98);
      --border: rgba(148, 163, 184, 0.18);
      --text-primary: #0f172a;
      --text-secondary: #334155;
      --text-muted: #64748b;
      --accent: #2563eb;
      --accent-strong: #1d4ed8;
      --shadow-lg: 0 28px 50px -38px rgba(15, 23, 42, 0.18);
      background: radial-gradient(120% 120% at 50% 0%, rgba(59, 130, 246, 0.12) 0%, transparent 60%), var(--bg-primary);
    }
    body[data-theme="light"] .post-toc {
      background: rgba(255, 255, 255, 0.96);
    }
    body[data-theme="light"] .post-body {
      background: rgba(255, 255, 255, 0.96);
      color: var(--text-secondary);
    }
    body[data-theme="light"] .post-hero__category {
      background: rgba(37, 99, 235, 0.12);
      color: var(--accent-strong);
    }
    body[data-theme="light"] .post-body blockquote {
      background: rgba(37, 99, 235, 0.1);
      color: var(--text-primary);
    }
    a {
      color: inherit;
      text-decoration: none;
    }
    header.site-header {
      position: sticky;
      top: 0;
      z-index: 12;
      backdrop-filter: blur(14px);
      background: rgba(15, 23, 42, 0.85);
      border-bottom: 1px solid var(--border);
      transition: background 0.3s ease;
    }
    body[data-theme="light"] header.site-header {
      background: rgba(248, 250, 252, 0.9);
    }
    .site-header__inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1.15rem clamp(1.5rem, 3vw, 3rem);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.5rem;
    }
    .site-header__left {
      display: flex;
      align-items: center;
      gap: 1.75rem;
    }
    .logo {
      display: inline-flex;
      align-items: center;
      gap: 0.7rem;
      font-weight: 600;
      color: var(--text-primary);
      font-size: 1.05rem;
      letter-spacing: 0.01em;
    }
    .logo-img {
      width: 38px;
      height: 38px;
      border-radius: 12px;
      object-fit: cover;
      box-shadow: 0 8px 18px -12px rgba(15, 23, 42, 0.6);
    }
    .site-nav {
      display: flex;
      gap: 1.1rem;
      font-size: 0.95rem;
      font-weight: 500;
      color: var(--text-muted);
    }
    .site-nav a:hover {
      color: var(--accent);
    }
    .header-controls {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .lang-btn {
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text-primary);
      padding: 0.45rem 0.9rem;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, border 0.2s ease, transform 0.2s ease;
    }
    .lang-btn:hover:not(.lang-btn--disabled) {
      background: var(--accent);
      color: #ffffff;
      transform: translateY(-1px);
      border-color: transparent;
    }
    .lang-btn--disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    .theme-toggle {
      position: relative;
      width: 52px;
      height: 28px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--bg-card);
      cursor: pointer;
      padding: 0;
      transition: background 0.3s ease, border 0.3s ease;
      display: flex;
      align-items: center;
    }
    .theme-toggle .theme-thumb {
      position: absolute;
      top: 50%;
      left: 4px;
      transform: translateY(-50%);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #ffffff;
      color: #1f2937;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      transition: transform 0.3s ease, background 0.3s ease, color 0.3s ease;
      box-shadow: 0 6px 18px -8px rgba(15, 23, 42, 0.6);
    }
    body[data-theme="dark"] .theme-toggle .theme-thumb {
      transform: translate(20px, -50%);
      background: #1f2937;
      color: #f8fafc;
    }
    body[data-theme="dark"] .theme-toggle {
      background: rgba(37, 99, 235, 0.2);
      border-color: rgba(37, 99, 235, 0.3);
    }
    main.page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 3.5rem clamp(1.5rem, 3vw, 3rem) 4.5rem;
    }
    .post-hero {
      position: relative;
      overflow: hidden;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.22) 0%, rgba(14, 165, 233, 0.08) 60%), var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 28px;
      padding: 2.75rem;
      box-shadow: var(--shadow-lg);
      margin-bottom: 3rem;
    }
    .post-hero::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.22) 0%, transparent 55%);
      pointer-events: none;
    }
    .post-hero__icon {
      position: relative;
      font-size: 3.1rem;
      margin-bottom: 1.5rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .post-hero__category {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.4rem 1rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.35);
      color: #ffffff;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-bottom: 1.25rem;
      text-transform: uppercase;
      font-size: 0.8rem;
    }
    .post-hero__title {
      position: relative;
      margin: 0 0 1.25rem;
      font-size: clamp(2.4rem, 4vw, 3.2rem);
      letter-spacing: -0.025em;
      line-height: 1.2;
      color: var(--text-primary);
    }
    .post-hero__meta {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      gap: 1.25rem;
      color: var(--text-muted);
      font-size: 0.95rem;
      font-weight: 500;
    }
    .post-hero__meta span {
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
    }
    .post-layout {
      display: grid;
      grid-template-columns: minmax(220px, 300px) minmax(0, 1fr);
      gap: 2.75rem;
      align-items: flex-start;
    }
    .post-layout--single {
      grid-template-columns: minmax(0, 1fr);
    }
    .post-toc {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 22px;
      padding: 1.5rem 1.6rem 1.8rem;
      box-shadow: var(--shadow-lg);
      position: sticky;
      top: 120px;
      max-height: calc(100vh - 160px);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .post-toc__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      margin-bottom: 0.5rem;
    }
    .post-toc__title {
      text-transform: uppercase;
      font-size: 0.78rem;
      letter-spacing: 0.18em;
      font-weight: 700;
      color: var(--text-muted);
    }
    .post-toc__toggle {
      display: none;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-secondary);
      border-radius: 999px;
      padding: 0.25rem 0.8rem;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      align-items: center;
      gap: 0.4rem;
      transition: background 0.2s ease, border 0.2s ease, color 0.2s ease;
    }
    .post-toc__toggle:hover {
      background: rgba(96, 165, 250, 0.15);
      border-color: transparent;
      color: var(--accent);
    }
    .post-toc__content {
      margin-top: 0.6rem;
      overflow-y: auto;
      padding-right: 0.4rem;
      transition: max-height 0.25s ease, opacity 0.25s ease;
      max-height: calc(100vh - 220px);
    }
    .post-toc--collapsed .post-toc__content {
      max-height: 0;
      opacity: 0;
      margin-top: 0;
      pointer-events: none;
    }
    .post-toc__list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 0.45rem;
    }
    .post-toc__sublist {
      margin-left: 0.85rem;
      padding-left: 0.85rem;
      border-left: 1px solid rgba(148, 163, 184, 0.35);
      margin-top: 0.4rem;
      gap: 0.35rem;
    }
    .post-toc__item {
      margin: 0;
    }
    .post-toc__link {
      color: var(--text-secondary);
      font-size: 0.95rem;
      line-height: 1.45;
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
      border-bottom: 1px dashed transparent;
      transition: color 0.2s ease, border-bottom 0.2s ease, transform 0.2s ease;
    }
    .post-toc__link:hover {
      color: var(--accent);
      border-bottom-color: rgba(96, 165, 250, 0.4);
      transform: translateX(2px);
    }
    .post-toc__link--active {
      color: var(--accent-strong);
      border-bottom-color: var(--accent-strong);
    }
    .post-toc__number {
      font-variant-numeric: tabular-nums;
      font-size: 0.85rem;
      color: var(--text-muted);
      min-width: 2.5ch;
      display: inline-flex;
      justify-content: flex-end;
      padding-top: 0.15rem;
    }
    .post-toc__text {
      flex: 1;
    }
    .post-body {
      background: var(--bg-card-strong);
      border: 1px solid var(--border);
      border-radius: 26px;
      padding: 2.5rem;
      box-shadow: var(--shadow-lg);
      font-size: 1.04rem;
      line-height: 1.75;
      color: var(--text-secondary);
    }
    .post-body h2 {
      margin-top: 2.75rem;
      margin-bottom: 1.25rem;
      font-size: clamp(1.9rem, 3vw, 2.35rem);
      color: var(--text-primary);
      letter-spacing: -0.01em;
    }
    .post-body h3 {
      margin-top: 2.2rem;
      margin-bottom: 1rem;
      font-size: 1.5rem;
      color: var(--text-primary);
    }
    .post-body h4 {
      margin-top: 1.8rem;
      margin-bottom: 0.75rem;
      font-size: 1.2rem;
      color: var(--text-primary);
    }
    .post-body p {
      margin-bottom: 1.4rem;
    }
    .post-body .post-warning {
      margin: 2rem 0;
      border-radius: 18px;
      border: 1px solid rgba(250, 204, 21, 0.35);
      background: rgba(254, 243, 199, 0.9);
      color: #4a3b0a;
      padding: 0 1.25rem 1rem;
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.35);
    }
    body[data-theme="dark"] .post-body .post-warning {
      background: rgba(253, 230, 138, 0.12);
      border-color: rgba(251, 191, 36, 0.5);
      color: #f6e6b2;
      box-shadow: inset 0 0 0 1px rgba(250, 200, 88, 0.3);
    }
    .post-body .post-warning summary {
      list-style: none;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem 0;
      color: inherit;
    }
    .post-body .post-warning summary::-webkit-details-marker {
      display: none;
    }
    .post-body .post-warning summary::before {
      content: '‚ö†Ô∏è';
      font-size: 1rem;
    }
    .post-body .post-warning[open] {
      padding-bottom: 1.25rem;
    }
    .post-body .post-warning p:last-child {
      margin-bottom: 0;
    }
    .post-body ul,
    .post-body ol {
      margin: 1.4rem 0 1.4rem 1.4rem;
      padding: 0;
    }
    .post-body li {
      margin-bottom: 0.8rem;
    }
    .post-body a {
      color: var(--accent);
      text-decoration: none;
      border-bottom: 1px solid rgba(96, 165, 250, 0.35);
      transition: color 0.2s ease, border-bottom 0.2s ease;
    }
    .post-body a:hover {
      color: var(--accent-strong);
      border-bottom-color: var(--accent-strong);
    }
    .post-body blockquote {
      margin: 2rem 0;
      padding: 1.5rem 1.75rem;
      border-left: 4px solid var(--accent);
      border-radius: 0 18px 18px 0;
      background: rgba(37, 99, 235, 0.12);
      color: var(--text-primary);
    }
    .post-body code {
      background: var(--code-inline-bg);
      color: var(--code-text);
      padding: 0.2rem 0.45rem;
      border-radius: 6px;
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 0.9rem;
    }
    .post-body pre code {
      background: transparent;
      padding: 0;
      display: block;
      font-size: inherit;
      line-height: inherit;
    }
    .hljs {
      color: #e2e8f0;
      background: transparent;
    }
    .hljs-comment,
    .hljs-quote {
      color: #7dd79d;
      font-style: italic;
    }
    .hljs-keyword,
    .hljs-selector-tag,
    .hljs-literal,
    .hljs-name,
    .hljs-strong,
    .hljs-built_in {
      color: #7dd3fc;
      font-weight: 600;
    }
    .hljs-title,
    .hljs-section,
    .hljs-function,
    .hljs-meta .hljs-keyword {
      color: #38bdf8;
      font-weight: 600;
    }
    .hljs-string,
    .hljs-doctag,
    .hljs-addition,
    .hljs-attribute,
    .hljs-template-tag,
    .hljs-template-variable {
      color: #facc15;
    }
    .hljs-number,
    .hljs-symbol,
    .hljs-bullet,
    .hljs-link,
    .hljs-meta,
    .hljs-type {
      color: #f472b6;
    }
    .hljs-variable,
    .hljs-params {
      color: #cbd5f5;
    }
    .post-body pre {
      background: var(--code-block-bg);
      color: var(--code-text);
      padding: 1.2rem 1.4rem;
      padding-right: 3.6rem;
      border-radius: 18px;
      overflow-x: auto;
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 0.95rem;
      box-shadow: var(--code-shadow);
      border: 1px solid var(--code-border);
      margin: 2rem 0;
      position: relative;
    }
    .code-copy-btn {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: rgba(15, 23, 42, 0.8);
      color: #e2e8f0;
      border: 1px solid rgba(148, 163, 184, 0.35);
      border-radius: 999px;
      padding: 0.25rem 0.85rem;
      font-size: 0.85rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease;
    }
    .code-copy-btn:hover {
      background: rgba(96, 165, 250, 0.85);
      color: #ffffff;
      border-color: transparent;
      transform: translateY(-1px);
    }
    .code-copy-btn--copied {
      background: rgba(34, 197, 94, 0.85);
      color: #ffffff;
      border-color: transparent;
    }
    .code-copy-btn__icon {
      font-size: 0.95rem;
    }
    .code-copy-btn__text {
      display: inline-block;
    }
    body[data-theme="light"] .code-copy-btn {
      background: rgba(248, 250, 252, 0.85);
      color: #0f172a;
      border-color: rgba(148, 163, 184, 0.4);
    }
    body[data-theme="light"] .code-copy-btn--copied {
      background: rgba(34, 197, 94, 0.92);
      color: #ffffff;
    }
    .post-body img {
      max-width: 100%;
      border-radius: 18px;
      margin: 2.2rem 0;
      box-shadow: 0 24px 45px -28px rgba(15, 23, 42, 0.55);
    }
    .post-body .table-wrapper {
      margin: 2rem 0;
      border-radius: 18px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.55);
      box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.12);
      position: relative;
      overflow: hidden;
    }
    .post-body .table-wrapper__scroll {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .post-body .table-wrapper__scroll::-webkit-scrollbar {
      height: 10px;
    }
    .post-body .table-wrapper__scroll::-webkit-scrollbar-thumb {
      background: rgba(96, 165, 250, 0.4);
      border-radius: 999px;
    }
    .post-body .table-wrapper table {
      width: 100%;
      border-collapse: collapse;
      background: transparent;
    }
    .post-body .table-wrapper[data-table-size="medium"] table {
      min-width: 720px;
    }
    .post-body .table-wrapper[data-table-size="wide"] table {
      min-width: 960px;
    }
    .post-body .table-wrapper thead th {
      background: rgba(96, 165, 250, 0.12);
      color: var(--text-primary);
      font-weight: 600;
    }
    .post-body .table-wrapper th,
    .post-body .table-wrapper td {
      padding: 0.9rem 1rem;
      text-align: left;
      border-bottom: 1px solid rgba(148, 163, 184, 0.18);
      white-space: nowrap;
    }
    .post-body .table-wrapper td {
      white-space: normal;
    }
    .post-body .table-wrapper tr:last-child td {
      border-bottom: none;
    }
    .post-body .table-wrapper__expand {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(148, 163, 184, 0.3);
      color: var(--accent);
      border-radius: 999px;
      padding: 0.35rem 0.9rem;
      font-size: 0.85rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
      z-index: 2;
    }
    .post-body .table-wrapper__expand:hover {
      background: rgba(37, 99, 235, 0.35);
      color: #ffffff;
      transform: translateY(-1px);
      border-color: transparent;
    }
    .table-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.85);
      backdrop-filter: blur(6px);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      z-index: 999;
    }
    .table-overlay--visible {
      display: flex;
    }
    .table-overlay__content {
      background: var(--bg-card-strong);
      border: 1px solid var(--border);
      border-radius: 24px;
      max-width: min(1080px, 92vw);
      max-height: 85vh;
      width: 100%;
      box-shadow: 0 32px 80px -40px rgba(15, 23, 42, 0.9);
      position: relative;
      overflow: hidden;
    }
    .table-overlay__close {
      position: absolute;
      top: 0.85rem;
      right: 0.85rem;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: var(--text-primary);
      border-radius: 999px;
      padding: 0.4rem 1rem;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease;
    }
    .table-overlay__close:hover {
      background: rgba(37, 99, 235, 0.4);
      color: #ffffff;
      border-color: transparent;
    }
    .table-overlay__scroll {
      overflow: auto;
      max-height: 85vh;
      padding: 2.5rem 2rem 2rem;
    }
    .table-overlay__scroll table {
      width: 100%;
      border-collapse: collapse;
      background: transparent;
    }
    .table-overlay__scroll table[data-table-size="medium"] {
      min-width: 720px;
    }
    .table-overlay__scroll table[data-table-size="wide"] {
      min-width: 960px;
    }
    .table-overlay__scroll thead th {
      background: rgba(96, 165, 250, 0.12);
      color: var(--text-primary);
      font-weight: 600;
    }
    .table-overlay__scroll th,
    .table-overlay__scroll td {
      padding: 0.9rem 1rem;
      text-align: left;
      border-bottom: 1px solid rgba(148, 163, 184, 0.18);
      white-space: nowrap;
    }
    .table-overlay__scroll td {
      white-space: normal;
    }
    .table-overlay__scroll tr:last-child td {
      border-bottom: none;
    }
    body[data-theme="light"] .post-body .table-wrapper {
      background: rgba(255, 255, 255, 0.96);
      box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.16);
    }
    body[data-theme="light"] .post-body .table-wrapper__expand {
      background: rgba(248, 250, 252, 0.9);
    }
    body[data-theme="light"] .table-overlay {
      background: rgba(15, 23, 42, 0.25);
    }
    body[data-theme="light"] .table-overlay__content {
      background: rgba(255, 255, 255, 0.98);
    }
    body.no-scroll {
      overflow: hidden;
    }
    footer {
      margin-top: 4rem;
      padding: 2rem 0;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.92rem;
      border-top: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.35);
    }
    body[data-theme="light"] footer {
      background: rgba(255, 255, 255, 0.72);
    }
    @media (max-width: 1024px) {
      .site-header__inner {
        padding: 1rem clamp(1.25rem, 4vw, 2rem);
      }
      main.page {
        padding: 2.75rem clamp(1.25rem, 4vw, 2rem) 4rem;
      }
      .post-layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .post-toc {
        position: sticky;
        top: 88px;
        z-index: 6;
        max-height: calc(100vh - 140px);
        margin-bottom: 2rem;
        padding: 1.1rem 1.25rem 1.35rem;
      }
      .post-toc__toggle {
        display: inline-flex;
      }
      .post-toc__content {
        max-height: none;
        margin-top: 0.4rem;
        overflow: visible;
      }
    }
    @media (max-width: 720px) {
      .post-hero {
        padding: 2.1rem 1.65rem;
      }
      .post-body {
        padding: 1.9rem 1.5rem;
      }
      .site-header__inner {
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;
      }
      .site-header__left {
        justify-content: space-between;
      }
      .header-controls {
        align-self: flex-end;
      }
      .post-hero__title {
        font-size: clamp(2rem, 6vw, 2.6rem);
      }
      .post-body .table-wrapper {
        margin: 1.6rem 0;
      }
      .post-body .table-wrapper__expand {
        top: 0.6rem;
        right: 0.6rem;
        font-size: 0.78rem;
        padding: 0.25rem 0.75rem;
      }
      .table-overlay__scroll {
        padding: 1.8rem 1.25rem 1.5rem;
      }
    }
  </style>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      },
    };
  </script>
  <script id="mathjax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head>
<body data-theme="dark">
  <header class="site-header">
    <div class="site-header__inner">
      <div class="site-header__left">
        <a class="logo" href="../../../index.html">
          <img src="../../../Assets/Logo.png" alt="Mirko Calcaterra logo" class="logo-img">
          <span class="logo-text">Mirko Calcaterra</span>
        </a>
        <nav class="site-nav">
          <a href="../../../index.html" data-it="Home" data-en="Home">Home</a>
          <a href="../../../blog/index.html" data-it="Blog" data-en="Blog">Blog</a>
        </nav>
      </div>
      <div class="header-controls">
        <button class="lang-btn" type="button">EN</button>
        <button class="theme-toggle" type="button" aria-label="Toggle theme">
          <span class="theme-thumb">‚òÄÔ∏è</span>
        </button>
      </div>
    </div>
  </header>
  <main class="page">
    <article class="post">
      <section class="post-hero">
        <div class="post-hero__icon">üìì</div>
        <span class="post-hero__category">AI Engineering Path</span>
        <h1 class="post-hero__title">Data Visualization Masterclass - Part 1</h1>
        <div class="post-hero__meta">
          <span>üìÖ February 18, 2026</span>
          <span>‚è±Ô∏è 20 min</span>
        </div>
      </section>
      <section class="post-layout">
        <aside class="post-toc" data-collapsed="false">
        <div class="post-toc__header">
          <div class="post-toc__title" data-it="Indice" data-en="Table of contents">Table of contents</div>
          <button class="post-toc__toggle" type="button" aria-expanded="true" aria-label="Hide table of contents">
            <span class="post-toc__toggle-text">Table of contents</span>
            <span class="post-toc__toggle-icon" aria-hidden="true">‚ñæ</span>
          </button>
        </div>
        <div class="post-toc__content">
          <ul class="post-toc__list">
    <li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#so-what-framework-pyramid-principle-and-the-fundamentals-of-dataviz">
            <span class="post-toc__number">1</span>
            <span class="post-toc__text">&quot;So What?&quot; Framework, Pyramid Principle and the fundamentals of Dataviz</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#notebook-structure">
            <span class="post-toc__number">1.1</span>
            <span class="post-toc__text">Notebook Structure</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#what-is-the-pyramid-principle">
            <span class="post-toc__number">2</span>
            <span class="post-toc__text">What is the Pyramid Principle?</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#the-idea-in-brief">
            <span class="post-toc__number">2.1</span>
            <span class="post-toc__text">The idea in brief</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#the-pyramid-structure">
            <span class="post-toc__number">2.2</span>
            <span class="post-toc__text">The pyramid structure</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#the-3-fundamental-rules">
            <span class="post-toc__number">2.3</span>
            <span class="post-toc__text">The 3 fundamental rules</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#the-so-what-framework">
            <span class="post-toc__number">3</span>
            <span class="post-toc__text">The &quot;So What?&quot; Framework</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#how-it-works">
            <span class="post-toc__number">3.1</span>
            <span class="post-toc__text">How it works</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#the-3-levels-of-so-what">
            <span class="post-toc__number">3.2</span>
            <span class="post-toc__text">The 3 levels of &quot;So What?&quot;</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#complete-editorial-example">
            <span class="post-toc__number">3.3</span>
            <span class="post-toc__text">Complete editorial example</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#descriptive-titles-vs-so-what-titles">
            <span class="post-toc__number">4</span>
            <span class="post-toc__text">Descriptive titles vs. &quot;So What?&quot; titles</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#how-ai-changes-the-analytical-workflow">
            <span class="post-toc__number">5</span>
            <span class="post-toc__text">How AI changes the analytical workflow</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#where-ai-is-strongest-and-where-not">
            <span class="post-toc__number">5.1</span>
            <span class="post-toc__text">Where AI is strongest (and where not)</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#the-prompt-pattern-for-the-so-what">
            <span class="post-toc__number">5.2</span>
            <span class="post-toc__text">The prompt pattern for the &quot;So What?&quot;</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#generative-datavis">
            <span class="post-toc__number">6</span>
            <span class="post-toc__text">Generative Datavis</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#installation-and-import">
            <span class="post-toc__number">7</span>
            <span class="post-toc__text">Installation and import</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#editorial-dataset-creation">
            <span class="post-toc__number">8</span>
            <span class="post-toc__text">Editorial dataset creation</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#comparison-charts-50-shades-of-bar-chart">
            <span class="post-toc__number">9</span>
            <span class="post-toc__text">Comparison charts: 50 shades of Bar Chart</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#grouped-bar-chart">
            <span class="post-toc__number">9.1</span>
            <span class="post-toc__text">Grouped Bar Chart</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#lollipop-chart-the-best-data-ink-ratio-of-the-bar-chart">
            <span class="post-toc__number">9.2</span>
            <span class="post-toc__text">Lollipop Chart: the best data-ink ratio of the bar chart</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#distribution-charts">
            <span class="post-toc__number">10</span>
            <span class="post-toc__text">Distribution Charts</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#histogram-pay-attention-to-the-number-of-bins">
            <span class="post-toc__number">10.1</span>
            <span class="post-toc__text">Histogram: pay attention to the number of bins!</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#box-plot-5-statistics-in-one-go">
            <span class="post-toc__number">10.2</span>
            <span class="post-toc__text">Box Plot: 5 statistics in one go</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#violin-plot">
            <span class="post-toc__number">10.3</span>
            <span class="post-toc__text">Violin Plot</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="2">
          <a class="post-toc__link" href="#why-the-log10-scale">
            <span class="post-toc__number">10.3.1</span>
            <span class="post-toc__text">Why the log10 scale?</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#kde-plot">
            <span class="post-toc__number">10.4</span>
            <span class="post-toc__text">KDE Plot</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#relationship-charts">
            <span class="post-toc__number">11</span>
            <span class="post-toc__text">Relationship Charts</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#scatter-plot">
            <span class="post-toc__number">11.1</span>
            <span class="post-toc__text">Scatter Plot</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#heatmap-seasonality-by-genre">
            <span class="post-toc__number">11.2</span>
            <span class="post-toc__text">Heatmap: Seasonality by genre</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#correlation-matrix">
            <span class="post-toc__number">11.3</span>
            <span class="post-toc__text">Correlation matrix</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#composition-charts">
            <span class="post-toc__number">12</span>
            <span class="post-toc__text">Composition charts</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#stacked-bar-100">
            <span class="post-toc__number">12.1</span>
            <span class="post-toc__text">Stacked Bar 100%</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#treemap-interactive-plotly">
            <span class="post-toc__number">12.2</span>
            <span class="post-toc__text">Treemap (Interactive Plotly)</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#note-on-the-pie-chart">
            <span class="post-toc__number">12.3</span>
            <span class="post-toc__text">Note on the Pie Chart</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#time-series-charts">
            <span class="post-toc__number">13</span>
            <span class="post-toc__text">Time series charts</span>
          </a>
          <ul class="post-toc__list post-toc__sublist">
    <li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#line-chart">
            <span class="post-toc__number">13.1</span>
            <span class="post-toc__text">Line Chart</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="1">
          <a class="post-toc__link" href="#stacked-area-chart">
            <span class="post-toc__number">13.2</span>
            <span class="post-toc__text">Stacked Area Chart</span>
          </a>
          
        </li>
  </ul>
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#the-power-of-annotations">
            <span class="post-toc__number">14</span>
            <span class="post-toc__text">The power of annotations</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#color-in-data-visualization">
            <span class="post-toc__number">15</span>
            <span class="post-toc__text">Color in Data Visualization</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#small-multiples">
            <span class="post-toc__number">16</span>
            <span class="post-toc__text">Small Multiples</span>
          </a>
          
        </li><li class="post-toc__item" data-depth="0">
          <a class="post-toc__link" href="#in-the-next-notebook-parte-2">
            <span class="post-toc__number">17</span>
            <span class="post-toc__text">In the next notebook (Parte 2)</span>
          </a>
          
        </li>
  </ul>
        </div>
      </aside>
        <div class="post-body">
          <h2 id="so-what-framework-pyramid-principle-and-the-fundamentals-of-dataviz">&quot;So What?&quot; Framework, Pyramid Principle and the fundamentals of Dataviz</h2>
<p><strong>Context:</strong> This educational notebook was designed for the advanced Data Analysis lesson for Mondadori (March 2026).
<strong>Dataset:</strong> The data has been simulated, inspired by the publishing world (book catalog, sales, performance)
<strong>Tools:</strong> Python ¬∑ Pandas ¬∑ Matplotlib ¬∑ Seaborn ¬∑ Plotly</p>
<h3 id="notebook-structure">Notebook Structure</h3>
<figure class="table-wrapper" data-enhanced-table><div class="table-wrapper__scroll"><table>
<thead>
<tr>
<th>Part</th>
<th>Content</th>
</tr>
</thead>
<tbody><tr>
<td><strong>1</strong></td>
<td>Barbara Minto&#39;s Pyramid Principle and the &quot;So What?&quot; framework</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>How AI integrates into the analysis and storytelling process</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>Setup: simulated editorial dataset</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>Visual grammar: the building blocks of data visualization</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>The &quot;catalog&quot; of fundamental charts</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>Basic techniques: color, annotations, layout</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>Guided exercise: from data to insight with the Pyramid Principle</td>
</tr>
</tbody></table>
</div></figure><blockquote>
<p><strong>Note:</strong> In <strong>Part 2</strong> (next notebook) we will see <em>when</em> to choose which chart based on the communication objective and data transformation techniques.</p>
</blockquote>
<hr>
<h1 id="the-pyramid-principle-and-the-so-what-framework">The Pyramid Principle and the &quot;So What?&quot; framework</h1>
<h2 id="what-is-the-pyramid-principle">What is the Pyramid Principle?</h2>
<p>The <strong>Pyramid Principle</strong> is a communication framework developed by <strong>Barbara Minto</strong> in the 1970s during her work at McKinsey. It is the standard method used in top consulting firms to structure any type of analytical communication.</p>
<h3 id="the-idea-in-brief">The idea in brief</h3>
<blockquote>
<p><strong>Every effective communication starts with the conclusion, not the data.</strong></p>
</blockquote>
<p>Most people communicate in a <strong>bottom-up</strong> manner: they start with data, build the analysis, and only at the end arrive at the conclusion. The Pyramid Principle reverses this approach:</p>
<pre><code class="hljs language-armasm">‚ùå Bottom-up (how we naturally think):
   <span class="hljs-meta">Data</span> ‚Üí <span class="hljs-meta">Data</span> ‚Üí <span class="hljs-meta">Data</span> ‚Üí Analysis ‚Üí Conclusion

‚úÖ Top-down (how we should communicate):
   Conclusion ‚Üí Argument <span class="hljs-number">1</span> ‚Üí Argument <span class="hljs-number">2</span> ‚Üí Argument <span class="hljs-number">3</span>
                      ‚Üì              ‚Üì              ‚Üì
                   Evidence       Evidence       Evidence</code></pre><h3 id="the-pyramid-structure">The pyramid structure</h3>
<pre><code class="hljs language-tap">                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   MAIN MESSAGE  ‚îÇ  ‚Üê The answer / recommendation
                    ‚îÇ                 ‚îÇ     (a single sentence)
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ              ‚îÇ              ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ Argument  ‚îÇ  ‚îÇ Argument  ‚îÇ  ‚îÇ Argument  ‚îÇ  ‚Üê Key reasons
        ‚îÇ    <span class="hljs-number"> 1 </span>    ‚îÇ  ‚îÇ    <span class="hljs-number"> 2 </span>    ‚îÇ  ‚îÇ    <span class="hljs-number"> 3 </span>    ‚îÇ     (MECE)
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ              ‚îÇ              ‚îÇ
          Evidence       Evidence       Evidence     ‚Üê Data, charts, facts</code></pre><h3 id="the-3-fundamental-rules">The 3 fundamental rules</h3>
<ol>
<li><p><strong>Start with the answer</strong> ‚Äî The main message goes at the top.</p>
</li>
<li><p><strong>Group in a MECE way</strong> ‚Äî <strong>M</strong>utually <strong>E</strong>xclusive, <strong>C</strong>ollectively <strong>E</strong>xhaustive: arguments do not overlap and, together, cover everything.</p>
</li>
<li><p><strong>Order logically</strong> ‚Äî By time, structure, or importance (you decide üòá).</p>
</li>
</ol>
<h2 id="the-so-what-framework">The &quot;So What?&quot; Framework</h2>
<p>The &quot;So What?&quot; test is the quality mechanism of the Pyramid Principle. It applies to every single element of the analysis, particularly to charts.</p>
<h3 id="how-it-works">How it works</h3>
<pre><code class="hljs language-smalltalk">üìä <span class="hljs-comment">&quot;Thriller genre sales grew by 23% in Q3&quot;</span>
   ‚îî‚îÄ <span class="hljs-type">So</span> what?
      <span class="hljs-comment">&quot;Thriller is outperforming all other genres&quot;</span>
      ‚îî‚îÄ <span class="hljs-type">So</span> what?
         <span class="hljs-comment">&quot;We should reallocate the editorial budget: +30% thriller, -15% poetry&quot;</span>
         ‚îî‚îÄ <span class="hljs-type">So</span> what?
            <span class="hljs-comment">&quot;Recommendation: Present the reallocation plan for Q1 to the editorial committee, with 3 new thriller titles in the pipeline&quot;</span></code></pre><h3 id="the-3-levels-of-so-what">The 3 levels of &quot;So What?&quot;</h3>
<figure class="table-wrapper" data-enhanced-table><div class="table-wrapper__scroll"><table>
<thead>
<tr>
<th>Level</th>
<th>Question</th>
<th>Output</th>
</tr>
</thead>
<tbody><tr>
<td><strong>L1 ‚Äî Observation</strong></td>
<td><em>What do I see?</em></td>
<td>Pattern description</td>
</tr>
<tr>
<td><strong>L2 ‚Äî Insight</strong></td>
<td><em>Why is it important?</em></td>
<td>Business interpretation</td>
</tr>
<tr>
<td><strong>L3 ‚Äî Action</strong></td>
<td><em>What do we do?</em></td>
<td>Concrete recommendation</td>
</tr>
</tbody></table>
</div></figure><h3 id="complete-editorial-example">Complete editorial example</h3>
<pre><code class="hljs language-nestedtext"><span class="hljs-attribute">MAIN MESSAGE</span><span class="hljs-punctuation">:</span>
<span class="hljs-attribute">&quot;The catalog needs to be rebalanced</span><span class="hljs-punctuation">:</span> <span class="hljs-string">60% of revenue</span>
<span class="hljs-attribute">comes from 15% of titles, and growing genres are underrepresented.&quot;

‚îú‚îÄ‚îÄ ARG 1</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Excessive revenue concentration</span>
<span class="hljs-attribute">‚îÇ   ‚îú‚îÄ‚îÄ Chart</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Pareto curve titles vs revenue</span>
<span class="hljs-attribute">‚îÇ   ‚îî‚îÄ‚îÄ So What</span><span class="hljs-punctuation">:</span> <span class="hljs-string">High risk if 2-3 bestsellers underperform</span>
<span class="hljs-attribute">‚îÇ
‚îú‚îÄ‚îÄ ARG 2</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Mismatch between catalog and demand</span>
<span class="hljs-attribute">‚îÇ   ‚îú‚îÄ‚îÄ Chart</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Genre growth vs % catalog</span>
<span class="hljs-attribute">‚îÇ   ‚îî‚îÄ‚îÄ So What</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Estimated lost opportunity ‚Ç¨2.4M/year</span>
<span class="hljs-attribute">‚îÇ
‚îî‚îÄ‚îÄ ARG 3</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Competitors are moving</span>
    <span class="hljs-attribute">‚îú‚îÄ‚îÄ Chart</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Market shares by genre (YoY)</span>
    <span class="hljs-attribute">‚îî‚îÄ‚îÄ So What</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Window of opportunity is closing</span></code></pre><h2 id="descriptive-titles-vs-so-what-titles">Descriptive titles vs. &quot;So What?&quot; titles</h2>
<figure class="table-wrapper" data-enhanced-table><div class="table-wrapper__scroll"><table>
<thead>
<tr>
<th>‚ùå Descriptive</th>
<th>‚úÖ &quot;So What?&quot;</th>
</tr>
</thead>
<tbody><tr>
<td>Monthly sales 2024</td>
<td>Sales are down 12% since Q2: intervention needed</td>
</tr>
<tr>
<td>Distribution by genre</td>
<td>70% of the catalog is in contracting genres</td>
</tr>
<tr>
<td>Author comparison</td>
<td>Top 5 authors generate more revenue than the remaining 200 combined</td>
</tr>
<tr>
<td>Quarterly trend</td>
<td>Q3 is the critical quarter: every year we lose 18%</td>
</tr>
</tbody></table>
</div></figure><blockquote>
<p><strong>Golden rule:</strong> If the title of your chart could be the title of <em>any</em> chart on the same topic, it&#39;s not a good title. A good title already contains the insight.</p>
</blockquote>
<hr>
<h1 id="ai-as-an-accelerator-of-the-so-what">AI as an accelerator of the &quot;So What?&quot;</h1>
<h2 id="how-ai-changes-the-analytical-workflow">How AI changes the analytical workflow</h2>
<pre><code class="hljs language-haskell"><span class="hljs-type">TRADITIONAL</span> (hours/days):
<span class="hljs-type">Raw</span> <span class="hljs-class"><span class="hljs-keyword">data</span> ‚Üí <span class="hljs-type">Cleaning</span> ‚Üí <span class="hljs-type">Exploration</span> ‚Üí <span class="hljs-type">Charts</span> ‚Üí <span class="hljs-type">Patterns</span> ‚Üí <span class="hljs-type">Insight</span> ‚Üí <span class="hljs-type">Slides</span></span>

<span class="hljs-type">AI</span>-<span class="hljs-type">AUGMENTED</span> (minutes/hours):
<span class="hljs-type">Raw</span> <span class="hljs-class"><span class="hljs-keyword">data</span> ‚Üí <span class="hljs-type">AI</span>: cleaning + <span class="hljs-type">EDA</span> ‚Üí <span class="hljs-type">Human</span>: validation ‚Üí <span class="hljs-type">AI</span>: charts + draft insight</span>
                                       ‚Üì
                              <span class="hljs-type">Human</span>: <span class="hljs-string">&quot;So What?&quot;</span> test
                                       ‚Üì
                              <span class="hljs-type">AI</span>: refinement + presentation</code></pre><h3 id="where-ai-is-strongest-and-where-not">Where AI is strongest (and where not)</h3>
<figure class="table-wrapper" data-enhanced-table><div class="table-wrapper__scroll"><table>
<thead>
<tr>
<th>Task</th>
<th>Is AI good?</th>
<th>Notes</th>
</tr>
</thead>
<tbody><tr>
<td>Generate code for charts</td>
<td>‚úÖ‚úÖ‚úÖ</td>
<td>Describe what you want, it generates the code</td>
</tr>
<tr>
<td>Explore patterns in data</td>
<td>‚úÖ‚úÖ</td>
<td>Good for initial EDA</td>
</tr>
<tr>
<td>Suggest &quot;So What?&quot; L1 (observation)</td>
<td>‚úÖ‚úÖ</td>
<td>Describes patterns well</td>
</tr>
<tr>
<td>Suggest &quot;So What?&quot; L2 (insight)</td>
<td>‚úÖ</td>
<td>Requires domain context</td>
</tr>
<tr>
<td>Suggest &quot;So What?&quot; L3 (action)</td>
<td>‚ö†Ô∏è</td>
<td>Always requires human validation</td>
</tr>
<tr>
<td>Business context knowledge</td>
<td>‚ùå</td>
<td>Here the data scientist is needed</td>
</tr>
</tbody></table>
</div></figure><h3 id="the-prompt-pattern-for-the-so-what">The prompt pattern for the &quot;So What?&quot;</h3>
<pre><code class="hljs language-livecodeserver">CONTEXT: [Describe <span class="hljs-keyword">the</span> business context]
DATA/CHART: [Describe what <span class="hljs-keyword">it</span> shows]
QUESTION: Apply <span class="hljs-keyword">the</span> <span class="hljs-string">&quot;So What?&quot;</span> framework <span class="hljs-keyword">at</span> <span class="hljs-number">3</span> levels:
- L1: What <span class="hljs-built_in">do</span> we observe?
- L2: Why is <span class="hljs-keyword">it</span> important <span class="hljs-keyword">for</span> [specific stakeholder]?
- L3: What concrete action <span class="hljs-built_in">do</span> we recommend?</code></pre><h2 id="generative-datavis">Generative Datavis</h2>
<blockquote>
<p><strong>Pro tip:</strong> When you ask AI to generate a chart, <strong>don&#39;t just say &quot;make me a bar chart&quot;</strong>. Say <strong>&quot;generate the code for me to create a chart showing that thriller is dominating sales&quot;</strong>. Start with the message, not the chart type.</p>
</blockquote>
<hr>
<h1 id="setup-and-editorial-dataset-creation">Setup and editorial dataset creation</h1>
<h2 id="installation-and-import">Installation and import</h2>
<pre><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> matplotlib.ticker <span class="hljs-keyword">as</span> mticker
<span class="hljs-keyword">import</span> matplotlib.dates <span class="hljs-keyword">as</span> mdates
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta
<span class="hljs-keyword">import</span> warnings
warnings.filterwarnings(<span class="hljs-string">&#x27;ignore&#x27;</span>)

<span class="hljs-keyword">import</span> plotly.express <span class="hljs-keyword">as</span> px
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">from</span> plotly.subplots <span class="hljs-keyword">import</span> make_subplots

plt.rcParams[<span class="hljs-string">&#x27;figure.figsize&#x27;</span>] = (<span class="hljs-number">12</span>, <span class="hljs-number">6</span>)
plt.rcParams[<span class="hljs-string">&#x27;figure.dpi&#x27;</span>] = <span class="hljs-number">100</span>
plt.rcParams[<span class="hljs-string">&#x27;font.family&#x27;</span>] = <span class="hljs-string">&#x27;sans-serif&#x27;</span>
plt.rcParams[<span class="hljs-string">&#x27;axes.spines.top&#x27;</span>] = <span class="hljs-literal">False</span>
plt.rcParams[<span class="hljs-string">&#x27;axes.spines.right&#x27;</span>] = <span class="hljs-literal">False</span>
sns.set_palette(<span class="hljs-string">&quot;husl&quot;</span>)
np.random.seed(<span class="hljs-number">42</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Setup completato!&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   Pandas: <span class="hljs-subst">{pd.__version__}</span>&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   NumPy: <span class="hljs-subst">{np.__version__}</span>&quot;</span>)</code></pre><pre><code class="hljs language-text">Setup completato!
   Pandas: 2.2.2
   NumPy: 2.0.2</code></pre><h2 id="editorial-dataset-creation">Editorial dataset creation</h2>
<p>Let&#39;s create a realistic dataset inspired by the publishing world. The dataset simulates the catalog and sales of a publishing house with different series, genres, and authors.</p>
<blockquote>
<p><strong>Why simulate?</strong> Simulated data allows us to control patterns and ensure that every type of chart has something interesting to show.</p>
</blockquote>
<pre><code class="hljs language-python"><span class="hljs-comment"># DATASET ‚Äî Simulazione dati editoriali</span>

GENERI = [<span class="hljs-string">&#x27;Narrativa&#x27;</span>, <span class="hljs-string">&#x27;Thriller&#x27;</span>, <span class="hljs-string">&#x27;Saggistica&#x27;</span>, <span class="hljs-string">&#x27;Fantasy&#x27;</span>, <span class="hljs-string">&#x27;Romance&#x27;</span>,
          <span class="hljs-string">&#x27;Storico&#x27;</span>, <span class="hljs-string">&#x27;Sci-Fi&#x27;</span>, <span class="hljs-string">&#x27;Poesia&#x27;</span>, <span class="hljs-string">&#x27;Bambini&#x27;</span>, <span class="hljs-string">&#x27;Young Adult&#x27;</span>]
COLLANE = [<span class="hljs-string">&#x27;Oscar Mondadori&#x27;</span>, <span class="hljs-string">&#x27;Strade Blu&#x27;</span>, <span class="hljs-string">&#x27;Contemporanea&#x27;</span>, <span class="hljs-string">&#x27;Chrysalide&#x27;</span>,
           <span class="hljs-string">&#x27;Omnibus&#x27;</span>, <span class="hljs-string">&#x27;Piccoli Brividi&#x27;</span>, <span class="hljs-string">&#x27;Classici Moderni&#x27;</span>, <span class="hljs-string">&#x27;Voci&#x27;</span>]
FORMATI = [<span class="hljs-string">&#x27;Cartaceo&#x27;</span>, <span class="hljs-string">&#x27;Ebook&#x27;</span>, <span class="hljs-string">&#x27;Audiolibro&#x27;</span>]
CANALI = [<span class="hljs-string">&#x27;Libreria fisica&#x27;</span>, <span class="hljs-string">&#x27;Amazon&#x27;</span>, <span class="hljs-string">&#x27;E-commerce proprio&#x27;</span>, <span class="hljs-string">&#x27;GDO&#x27;</span>, <span class="hljs-string">&#x27;Fiere/Eventi&#x27;</span>]
GENERE_WEIGHTS = {
    <span class="hljs-string">&#x27;Narrativa&#x27;</span>: <span class="hljs-number">0.22</span>, <span class="hljs-string">&#x27;Thriller&#x27;</span>: <span class="hljs-number">0.18</span>, <span class="hljs-string">&#x27;Saggistica&#x27;</span>: <span class="hljs-number">0.15</span>,
    <span class="hljs-string">&#x27;Fantasy&#x27;</span>: <span class="hljs-number">0.10</span>, <span class="hljs-string">&#x27;Romance&#x27;</span>: <span class="hljs-number">0.09</span>, <span class="hljs-string">&#x27;Storico&#x27;</span>: <span class="hljs-number">0.08</span>,
    <span class="hljs-string">&#x27;Sci-Fi&#x27;</span>: <span class="hljs-number">0.06</span>, <span class="hljs-string">&#x27;Poesia&#x27;</span>: <span class="hljs-number">0.02</span>, <span class="hljs-string">&#x27;Bambini&#x27;</span>: <span class="hljs-number">0.05</span>, <span class="hljs-string">&#x27;Young Adult&#x27;</span>: <span class="hljs-number">0.05</span>}

n_libri = <span class="hljs-number">500</span>; n_mesi = <span class="hljs-number">24</span>

libri = pd.DataFrame({
    <span class="hljs-string">&#x27;libro_id&#x27;</span>: <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n_libri + <span class="hljs-number">1</span>),
    <span class="hljs-string">&#x27;titolo&#x27;</span>: [<span class="hljs-string">f&quot;Titolo_<span class="hljs-subst">{i:03d}</span>&quot;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n_libri + <span class="hljs-number">1</span>)],
    <span class="hljs-string">&#x27;genere&#x27;</span>: np.random.choice(<span class="hljs-built_in">list</span>(GENERE_WEIGHTS.keys()), n_libri, p=<span class="hljs-built_in">list</span>(GENERE_WEIGHTS.values())),
    <span class="hljs-string">&#x27;collana&#x27;</span>: np.random.choice(COLLANE, n_libri),
    <span class="hljs-string">&#x27;anno_pubblicazione&#x27;</span>: np.random.choice(<span class="hljs-built_in">range</span>(<span class="hljs-number">2018</span>, <span class="hljs-number">2025</span>), n_libri, p=[<span class="hljs-number">.05</span>,<span class="hljs-number">.05</span>,<span class="hljs-number">.08</span>,<span class="hljs-number">.10</span>,<span class="hljs-number">.15</span>,<span class="hljs-number">.25</span>,<span class="hljs-number">.32</span>]),
    <span class="hljs-string">&#x27;pagine&#x27;</span>: np.random.normal(<span class="hljs-number">280</span>, <span class="hljs-number">80</span>, n_libri).astype(<span class="hljs-built_in">int</span>).clip(<span class="hljs-number">80</span>, <span class="hljs-number">800</span>),
    <span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>: np.<span class="hljs-built_in">round</span>(np.random.uniform(<span class="hljs-number">9.90</span>, <span class="hljs-number">24.90</span>, n_libri), <span class="hljs-number">2</span>),
    <span class="hljs-string">&#x27;rating_goodreads&#x27;</span>: np.<span class="hljs-built_in">round</span>(np.random.normal(<span class="hljs-number">3.7</span>, <span class="hljs-number">0.5</span>, n_libri).clip(<span class="hljs-number">1.5</span>, <span class="hljs-number">5.0</span>), <span class="hljs-number">1</span>),
    <span class="hljs-string">&#x27;n_recensioni&#x27;</span>: np.random.exponential(<span class="hljs-number">150</span>, n_libri).astype(<span class="hljs-built_in">int</span>).clip(<span class="hljs-number">5</span>, <span class="hljs-number">5000</span>)})</code></pre><pre><code class="hljs language-python">libri.loc[libri[<span class="hljs-string">&#x27;genere&#x27;</span>] == <span class="hljs-string">&#x27;Thriller&#x27;</span>, <span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>] *= <span class="hljs-number">1.1</span>
libri.loc[libri[<span class="hljs-string">&#x27;genere&#x27;</span>] == <span class="hljs-string">&#x27;Narrativa&#x27;</span>, <span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>] *= <span class="hljs-number">1.05</span>
libri.loc[libri[<span class="hljs-string">&#x27;genere&#x27;</span>] == <span class="hljs-string">&#x27;Poesia&#x27;</span>, <span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>] *= <span class="hljs-number">0.8</span>
libri[<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>] = libri[<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>].<span class="hljs-built_in">round</span>(<span class="hljs-number">2</span>)

date_range = pd.date_range(<span class="hljs-string">&#x27;2023-01-01&#x27;</span>, periods=n_mesi, freq=<span class="hljs-string">&#x27;MS&#x27;</span>)
vendite_records = []
<span class="hljs-keyword">for</span> _, libro <span class="hljs-keyword">in</span> libri.iterrows():
    base = {<span class="hljs-string">&#x27;Narrativa&#x27;</span>:<span class="hljs-number">120</span>,<span class="hljs-string">&#x27;Thriller&#x27;</span>:<span class="hljs-number">150</span>,<span class="hljs-string">&#x27;Saggistica&#x27;</span>:<span class="hljs-number">80</span>,<span class="hljs-string">&#x27;Fantasy&#x27;</span>:<span class="hljs-number">90</span>,<span class="hljs-string">&#x27;Romance&#x27;</span>:<span class="hljs-number">70</span>,
            <span class="hljs-string">&#x27;Storico&#x27;</span>:<span class="hljs-number">50</span>,<span class="hljs-string">&#x27;Sci-Fi&#x27;</span>:<span class="hljs-number">45</span>,<span class="hljs-string">&#x27;Poesia&#x27;</span>:<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;Bambini&#x27;</span>:<span class="hljs-number">60</span>,<span class="hljs-string">&#x27;Young Adult&#x27;</span>:<span class="hljs-number">55</span>}[libro[<span class="hljs-string">&#x27;genere&#x27;</span>]]
    libro_mult = np.random.lognormal(<span class="hljs-number">0</span>, <span class="hljs-number">0.8</span>)
    <span class="hljs-keyword">for</span> i, data <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(date_range):
        m = data.month
        stag = {<span class="hljs-number">12</span>:<span class="hljs-number">1.8</span>, <span class="hljs-number">11</span>:<span class="hljs-number">1.3</span>, <span class="hljs-number">6</span>:<span class="hljs-number">1.2</span>, <span class="hljs-number">7</span>:<span class="hljs-number">1.2</span>, <span class="hljs-number">1</span>:<span class="hljs-number">0.7</span>, <span class="hljs-number">2</span>:<span class="hljs-number">0.7</span>}.get(m, <span class="hljs-number">1.0</span>)
        trend = {<span class="hljs-string">&#x27;Thriller&#x27;</span>:<span class="hljs-number">1</span>+i*<span class="hljs-number">0.015</span>,<span class="hljs-string">&#x27;Fantasy&#x27;</span>:<span class="hljs-number">1</span>+i*<span class="hljs-number">0.01</span>,<span class="hljs-string">&#x27;Young Adult&#x27;</span>:<span class="hljs-number">1</span>+i*<span class="hljs-number">0.012</span>,
                 <span class="hljs-string">&#x27;Poesia&#x27;</span>:<span class="hljs-number">1</span>-i*<span class="hljs-number">0.008</span>,<span class="hljs-string">&#x27;Saggistica&#x27;</span>:<span class="hljs-number">1</span>-i*<span class="hljs-number">0.003</span>}.get(libro[<span class="hljs-string">&#x27;genere&#x27;</span>], <span class="hljs-number">1.0</span>)
        <span class="hljs-keyword">for</span> fmt <span class="hljs-keyword">in</span> FORMATI:
            fs = {<span class="hljs-string">&#x27;Cartaceo&#x27;</span>:<span class="hljs-number">0.55</span>,<span class="hljs-string">&#x27;Ebook&#x27;</span>:<span class="hljs-number">0.30</span>,<span class="hljs-string">&#x27;Audiolibro&#x27;</span>:<span class="hljs-number">0.15</span>}[fmt]
            <span class="hljs-keyword">if</span> fmt==<span class="hljs-string">&#x27;Ebook&#x27;</span>: fs *= (<span class="hljs-number">1</span>+i*<span class="hljs-number">0.005</span>)
            <span class="hljs-keyword">if</span> fmt==<span class="hljs-string">&#x27;Audiolibro&#x27;</span>: fs *= (<span class="hljs-number">1</span>+i*<span class="hljs-number">0.02</span>)
            copie = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">int</span>(base*libro_mult*stag*trend*fs*np.random.lognormal(<span class="hljs-number">0</span>,<span class="hljs-number">0.3</span>)))
            <span class="hljs-keyword">if</span> copie &gt; <span class="hljs-number">0</span>:
                vendite_records.append({<span class="hljs-string">&#x27;libro_id&#x27;</span>:libro[<span class="hljs-string">&#x27;libro_id&#x27;</span>],<span class="hljs-string">&#x27;data&#x27;</span>:data,<span class="hljs-string">&#x27;formato&#x27;</span>:fmt,
                    <span class="hljs-string">&#x27;canale&#x27;</span>:np.random.choice(CANALI,p=[<span class="hljs-number">.30</span>,<span class="hljs-number">.35</span>,<span class="hljs-number">.15</span>,<span class="hljs-number">.12</span>,<span class="hljs-number">.08</span>]),<span class="hljs-string">&#x27;copie_vendute&#x27;</span>:copie,
                    <span class="hljs-string">&#x27;ricavo&#x27;</span>:<span class="hljs-built_in">round</span>(copie*libro[<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>]*{<span class="hljs-string">&#x27;Cartaceo&#x27;</span>:<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;Ebook&#x27;</span>:<span class="hljs-number">.65</span>,<span class="hljs-string">&#x27;Audiolibro&#x27;</span>:<span class="hljs-number">.55</span>}[fmt],<span class="hljs-number">2</span>)})

vendite = pd.DataFrame(vendite_records)
df = vendite.merge(libri, on=<span class="hljs-string">&#x27;libro_id&#x27;</span>, how=<span class="hljs-string">&#x27;left&#x27;</span>)
df[<span class="hljs-string">&#x27;anno&#x27;</span>] = df[<span class="hljs-string">&#x27;data&#x27;</span>].dt.year

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Dataset creato!&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   Libri: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(libri):,}</span> | Record vendite: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(vendite):,}</span>&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   Periodo: <span class="hljs-subst">{date_range[<span class="hljs-number">0</span>].strftime(<span class="hljs-string">&#x27;%b %Y&#x27;</span>)}</span> - <span class="hljs-subst">{date_range[-<span class="hljs-number">1</span>].strftime(<span class="hljs-string">&#x27;%b %Y&#x27;</span>)}</span>&quot;</span>)
df.head(<span class="hljs-number">3</span>)</code></pre><pre><code class="hljs language-text">Dataset creato!
   Libri: 500 | Record vendite: 35,904
   Periodo: Jan 2023 - Dec 2024</code></pre><pre><code class="hljs language-text">   libro_id       data     formato              canale  copie_vendute  \
0         1 2023-01-01    Cartaceo        Fiere/Eventi             43   
1         1 2023-01-01       Ebook  E-commerce proprio             15   
2         1 2023-01-01  Audiolibro              Amazon             11   

    ricavo      titolo    genere          collana  anno_pubblicazione  pagine  \
0  1035.87  Titolo_001  Thriller  Piccoli Brividi                2020     272   
1   234.88  Titolo_001  Thriller  Piccoli Brividi                2020     272   
2   145.74  Titolo_001  Thriller  Piccoli Brividi                2020     272   

   prezzo_copertina  rating_goodreads  n_recensioni  anno  
0             24.09               3.1             8  2023  
1             24.09               3.1             8  2023  
2             24.09               3.1             8  2023</code></pre><p>I want to point out just one thing: the dataset is generated from 3 nested loops, namely:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">For</span> <span class="hljs-keyword">each</span> book (<span class="hljs-number">500</span> books)
  ‚îî‚îÄ <span class="hljs-keyword">For</span> <span class="hljs-keyword">each</span> <span class="hljs-keyword">month</span> (<span class="hljs-number">24</span> months: Jan <span class="hljs-number">2023</span> ‚Üí <span class="hljs-type">Dec</span> <span class="hljs-number">2024</span>)
       ‚îî‚îÄ <span class="hljs-keyword">For</span> <span class="hljs-keyword">each</span> format (<span class="hljs-number">3</span>: Print, Ebook, Audiobook)</code></pre><p>The theoretical maximum would be 500 √ó 24 √ó 3 = 36,000 records. We get ~35,904 because some are discarded (copies = 0).</p>
<pre><code class="hljs language-python">df.info()</code></pre><pre><code class="hljs language-text">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;
RangeIndex: 35904 entries, 0 to 35903
Data columns (total 15 columns):
 #   Column              Non-Null Count  Dtype         
---  ------              --------------  -----         
 0   libro_id            35904 non-null  int64         
 1   data                35904 non-null  datetime64[ns]
 2   formato             35904 non-null  object        
 3   canale              35904 non-null  object        
 4   copie_vendute       35904 non-null  int64         
 5   ricavo              35904 non-null  float64       
 6   titolo              35904 non-null  object        
 7   genere              35904 non-null  object        
 8   collana             35904 non-null  object        
 9   anno_pubblicazione  35904 non-null  int64         
 10  pagine              35904 non-null  int64         
 11  prezzo_copertina    35904 non-null  float64       
 12  rating_goodreads    35904 non-null  float64       
 13  n_recensioni        35904 non-null  int64         
 14  anno                35904 non-null  int32         
dtypes: datetime64[ns](1), float64(3), int32(1), int64(5), object(5)
memory usage: 4.0+ MB</code></pre><pre><code class="hljs language-python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;DATASET SCHEMA&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nDimensions: <span class="hljs-subst">{df.shape[<span class="hljs-number">0</span>]:,}</span> rows x <span class="hljs-subst">{df.shape[<span class="hljs-number">1</span>]}</span> columns&quot;</span>)
<span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> df.columns:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;   <span class="hljs-subst">{col:25s}</span> <span class="hljs-subst">{<span class="hljs-built_in">str</span>(df[col].dtype):10s}</span>  (<span class="hljs-subst">{df[col].nunique():,}</span> unique)&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\nTotal revenue: EUR <span class="hljs-subst">{df[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>():,<span class="hljs-number">.0</span>f}</span>&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Total copies: <span class="hljs-subst">{df[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].<span class="hljs-built_in">sum</span>():,<span class="hljs-number">.0</span>f}</span>&quot;</span>)</code></pre><pre><code class="hljs language-text">============================================================
DATASET SCHEMA
============================================================</code></pre><p>Dimensioni: 35,904 righe x 15 colonne
   book_id                   int64       (500 unici)
   date                      datetime64[ns]  (24 unici)
   format                    object      (3 unici)
   channel                   object      (5 unici)
   copies_sold               int64       (680 unici)
   revenue                   float64     (22,906 unici)
   title                     object      (500 unici)
   genre                     object      (10 unici)
   series                    object      (8 unici)
   publication_year          int64       (7 unici)
   pages                     int64       (254 unici)
   cover_price               float64     (428 unici)
   goodreads_rating          float64     (28 unici)
   num_reviews               int64       (265 unici)
   year                      int32       (2 unici)</p>
<p>Total revenue: EUR 28,967,296
Total copies: 1,987,829</p>
<pre><code class="hljs language-pgsql">
<span class="hljs-comment">---</span>
# Visual grammar
We introduce the <span class="hljs-number">7</span> visual properties (position, length, angle, area, color saturation, color hue, shape) <span class="hljs-keyword">with</span> an effectiveness ranking <span class="hljs-keyword">for</span> quantitative vs categorical data.
We <span class="hljs-keyword">then</span> <span class="hljs-keyword">explain</span> Tuft<span class="hljs-string">e&#x27;s Data-Ink Ratio concept and examine it together.

## The 7 visual properties (Visual Encoding)

| # | Property | Quant. | Categ. |
|---|----------|--------|--------|
| 1 | **Position** (x/y axis) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| 2 | **Length** (bars) | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚Äî |
| 3 | **Angle/Slope** | ‚≠ê‚≠ê‚≠ê | ‚Äî |
| 4 | **Area** (bubble, treemap) | ‚≠ê‚≠ê | ‚Äî |
| 5 | **Color (saturation)** | ‚≠ê‚≠ê | ‚Äî |
| 6 | **Color (hue)** | ‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| 7 | **Shape** | ‚Äî | ‚≠ê‚≠ê‚≠ê |

## The Data-Ink Ratio (Edward Tufte)

&gt; *&quot;Excellence in statistical graphics consists of complex ideas communicated with clarity, precision, and efficiency.&quot;*

**Data-Ink Ratio** = Data ink / Total ink. It should tend towards 1.

```python
# Data-Ink Ratio ‚Äî Before and After
generi_top5 = df.groupby(&#x27;</span>gener<span class="hljs-string">e&#x27;)[&#x27;</span>ricavo<span class="hljs-string">&#x27;].sum().nlargest(5).sort_values()
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 5))

# PRIMA: basso data-ink ratio
ax1.barh(generi_top5.index, generi_top5.values/1e6,
         color=[&#x27;</span>#ff6b6b<span class="hljs-string">&#x27;,&#x27;</span>#ffa94d<span class="hljs-string">&#x27;,&#x27;</span>#ffd43b<span class="hljs-string">&#x27;,&#x27;</span>#<span class="hljs-number">69</span>db7c<span class="hljs-string">&#x27;,&#x27;</span>#<span class="hljs-number">4</span>dabf7<span class="hljs-string">&#x27;], edgecolor=&#x27;</span>black<span class="hljs-string">&#x27;, linewidth=1.5)
ax1.set_facecolor(&#x27;</span>#f0f0f0<span class="hljs-string">&#x27;); ax1.grid(True, linewidth=0.8, color=&#x27;</span>whit<span class="hljs-string">e&#x27;)
ax1.set_title(&#x27;</span>Revenue <span class="hljs-keyword">by</span> Genre (M EUR)<span class="hljs-string">&#x27;, fontsize=14, fontweight=&#x27;</span>bold<span class="hljs-string">&#x27;)
ax1.spines[&#x27;</span>top<span class="hljs-string">&#x27;].set_visible(True); ax1.spines[&#x27;</span>right<span class="hljs-string">&#x27;].set_visible(True)
for s in ax1.spines.values(): s.set_linewidth(2)
ax1.text(0.5,-0.15,&#x27;</span><span class="hljs-keyword">BEFORE</span>: too much ink, too little data<span class="hljs-string">&#x27;,transform=ax1.transAxes,ha=&#x27;</span>center<span class="hljs-string">&#x27;,fontsize=11,color=&#x27;</span>red<span class="hljs-string">&#x27;)

# DOPO: alto data-ink ratio
bars = ax2.barh(generi_top5.index, generi_top5.values/1e6, color=&#x27;</span>#<span class="hljs-number">2</span>c3e50<span class="hljs-string">&#x27;, height=0.6)
ax2.set_title(f&#x27;</span>Thriller leads revenue <span class="hljs-keyword">with</span> EUR {generi_top5.max()/<span class="hljs-number">1e6</span>:<span class="hljs-number">.1</span>f}M<span class="hljs-string">&#x27;,
              fontsize=13, fontweight=&#x27;</span>bold<span class="hljs-string">&#x27;, loc=&#x27;</span>left<span class="hljs-string">&#x27;, pad=10)
for sp in [&#x27;</span>top<span class="hljs-string">&#x27;,&#x27;</span>right<span class="hljs-string">&#x27;,&#x27;</span>bottom<span class="hljs-string">&#x27;,&#x27;</span>left<span class="hljs-string">&#x27;]: ax2.spines[sp].set_visible(False)
ax2.xaxis.set_visible(False); ax2.tick_params(left=False)
for bar,val in zip(bars, generi_top5.values/1e6):
    ax2.text(val+0.1, bar.get_y()+bar.get_height()/2, f&#x27;</span>EUR {val:<span class="hljs-number">.1</span>f}M<span class="hljs-string">&#x27;, va=&#x27;</span>center<span class="hljs-string">&#x27;, fontsize=11, fontweight=&#x27;</span>bold<span class="hljs-string">&#x27;)
bars[-1].set_color(&#x27;</span>#e74c3c<span class="hljs-string">&#x27;)
ax2.text(0.5,-0.15,&#x27;</span><span class="hljs-keyword">AFTER</span>: clean, &quot;So What?&quot; <span class="hljs-keyword">in</span> the titl<span class="hljs-string">e&#x27;,transform=ax2.transAxes,ha=&#x27;</span>center<span class="hljs-string">&#x27;,fontsize=11,color=&#x27;</span>green<span class="hljs-string">&#x27;)

plt.tight_layout(); plt.show()</span></code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-01.png" alt="Notebook output 1"></p>
<hr>
<h1 id="catalog-of-fundamental-charts">Catalog of fundamental charts</h1>
<p>For each chart family, we show a concrete example using the editorial dataset, always with a &quot;So What?&quot; title and annotations.</p>
<figure class="table-wrapper" data-enhanced-table><div class="table-wrapper__scroll"><table>
<thead>
<tr>
<th>Category</th>
<th>Charts</th>
<th>Question</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Comparison</strong></td>
<td>Bar, Grouped bar, Lollipop</td>
<td><em>Which is larger?</em></td>
</tr>
<tr>
<td><strong>Distribution</strong></td>
<td>Histogram, Box, Violin, KDE</td>
<td><em>How are they distributed?</em></td>
</tr>
<tr>
<td><strong>Relationship</strong></td>
<td>Scatter, Heatmap, Correlation</td>
<td><em>Is there a correlation?</em></td>
</tr>
<tr>
<td><strong>Hierarchy</strong></td>
<td>Stacked bar, Treemap</td>
<td><em>How and what is it composed of?</em></td>
</tr>
<tr>
<td><strong>Trend</strong></td>
<td>Line, Area</td>
<td><em>How does it change over time?</em></td>
</tr>
</tbody></table>
</div></figure><hr>
<h2 id="comparison-charts-50-shades-of-bar-chart">Comparison charts: 50 shades of Bar Chart</h2>
<p>The following horizontal bar chart shows revenue by genre ordered by value, with the top 2 highlighted in red/orange and a yellow box in the bottom right with the recommendation. The grouped bar chart compares copies sold by format across the top 5 genres, showing that print dominates everywhere. The lollipop chart visualizes the average Goodreads rating by genre with a vertical line at the global average and green/red points above/below average.</p>
<p><strong>Golden rules:</strong> horizontal bars for longer names, order by value on the Y-axis starting from zero.</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># BAR CHART: Revenue by Genre</span>
ricavi_genere = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().sort_values(ascending=<span class="hljs-literal">True</span>) / <span class="hljs-number">1e6</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))
colors = [<span class="hljs-string">&#x27;#2c3e50&#x27;</span>]*<span class="hljs-built_in">len</span>(ricavi_genere); colors[-<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;#e74c3c&#x27;</span>; colors[-<span class="hljs-number">2</span>]=<span class="hljs-string">&#x27;#e67e22&#x27;</span>
bars = ax.barh(ricavi_genere.index, ricavi_genere.values, color=colors, height=<span class="hljs-number">0.65</span>)
<span class="hljs-keyword">for</span> bar,val <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(bars, ricavi_genere.values):
    ax.text(val+<span class="hljs-number">0.15</span>, bar.get_y()+bar.get_height()/<span class="hljs-number">2</span>, <span class="hljs-string">f&#x27;EUR <span class="hljs-subst">{val:<span class="hljs-number">.1</span>f}</span>M&#x27;</span>, va=<span class="hljs-string">&#x27;center&#x27;</span>, fontsize=<span class="hljs-number">10</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,
            color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span> <span class="hljs-keyword">if</span> val==ricavi_genere.<span class="hljs-built_in">max</span>() <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#2c3e50&#x27;</span>)
ax.set_title(<span class="hljs-string">&#x27;Thriller and Fiction alone account for {:.0f}% of total revenue&#x27;</span>.<span class="hljs-built_in">format</span>(
    (ricavi_genere.nlargest(<span class="hljs-number">2</span>).<span class="hljs-built_in">sum</span>()/ricavi_genere.<span class="hljs-built_in">sum</span>())*<span class="hljs-number">100</span>),
    fontsize=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>, pad=<span class="hljs-number">15</span>)
ax.xaxis.set_visible(<span class="hljs-literal">False</span>)
<span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;bottom&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>]: ax.spines[sp].set_visible(<span class="hljs-literal">False</span>)
ax.tick_params(left=<span class="hljs-literal">False</span>)
ax.text(<span class="hljs-number">0.98</span>,<span class="hljs-number">0.02</span>,<span class="hljs-string">&#x27;So What? Dependence on 2 genres is a risk.\nDiversify into Fantasy, Non-Fiction, and Romance.&#x27;</span>,
        transform=ax.transAxes,fontsize=<span class="hljs-number">9</span>,va=<span class="hljs-string">&#x27;bottom&#x27;</span>,ha=<span class="hljs-string">&#x27;right&#x27;</span>,
        bbox=<span class="hljs-built_in">dict</span>(boxstyle=<span class="hljs-string">&#x27;round,pad=0.5&#x27;</span>,facecolor=<span class="hljs-string">&#x27;#fffde7&#x27;</span>,alpha=<span class="hljs-number">0.8</span>))
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-02.png" alt="Notebook output 2"></p>
<p>If a Thriller or Fiction bestseller underperforms, the impact on revenue is disproportionate due to a concentration risk.</p>
<p>It is therefore suggested to strengthen the &quot;medium&quot; genres (Fantasy, Non-Fiction, Romance) which already have significant volumes but can grow, to reduce dependence on the top 2.</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># BAR CHART with part-of-whole annotation</span>
ricavi_genere = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().sort_values(ascending=<span class="hljs-literal">True</span>) / <span class="hljs-number">1e6</span>
top2_pct = (ricavi_genere.nlargest(<span class="hljs-number">2</span>).<span class="hljs-built_in">sum</span>() / ricavi_genere.<span class="hljs-built_in">sum</span>()) * <span class="hljs-number">100</span>

fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))
colors = [<span class="hljs-string">&#x27;#2c3e50&#x27;</span>] * <span class="hljs-built_in">len</span>(ricavi_genere)
colors[-<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;#e74c3c&#x27;</span>
colors[-<span class="hljs-number">2</span>] = <span class="hljs-string">&#x27;#e67e22&#x27;</span>
bars = ax.barh(ricavi_genere.index, ricavi_genere.values, color=colors, height=<span class="hljs-number">0.65</span>)

<span class="hljs-keyword">for</span> bar, val <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(bars, ricavi_genere.values):
    ax.text(val + <span class="hljs-number">0.15</span>, bar.get_y() + bar.get_height() / <span class="hljs-number">2</span>,
            <span class="hljs-string">f&#x27;EUR <span class="hljs-subst">{val:<span class="hljs-number">.1</span>f}</span>M&#x27;</span>, va=<span class="hljs-string">&#x27;center&#x27;</span>, fontsize=<span class="hljs-number">10</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,
            color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span> <span class="hljs-keyword">if</span> val == ricavi_genere.<span class="hljs-built_in">max</span>() <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#2c3e50&#x27;</span>)

<span class="hljs-comment"># --- Visual &quot;bracket&quot; annotation for 60% ---</span>
n = <span class="hljs-built_in">len</span>(ricavi_genere)
y_top = n - <span class="hljs-number">1</span>      <span class="hljs-comment"># position of Thriller bar (highest, last in asc sort)</span>
y_second = n - <span class="hljs-number">2</span>   <span class="hljs-comment"># Fiction</span>
x_bracket = ricavi_genere.<span class="hljs-built_in">max</span>() + <span class="hljs-number">1.2</span>

<span class="hljs-comment"># Vertical and horizontal lines of the bracket</span>
ax.annotate(<span class="hljs-string">&#x27;&#x27;</span>, xy=(x_bracket, y_top + <span class="hljs-number">0.32</span>), xytext=(x_bracket, y_second - <span class="hljs-number">0.32</span>),
            arrowprops=<span class="hljs-built_in">dict</span>(arrowstyle=<span class="hljs-string">&#x27;-&#x27;</span>, color=<span class="hljs-string">&#x27;#555&#x27;</span>, lw=<span class="hljs-number">1.5</span>))
ax.plot([ricavi_genere.iloc[-<span class="hljs-number">1</span>] + <span class="hljs-number">0.15</span>, x_bracket], [y_top + <span class="hljs-number">0.32</span>, y_top + <span class="hljs-number">0.32</span>], color=<span class="hljs-string">&#x27;#555&#x27;</span>, lw=<span class="hljs-number">1.5</span>)
ax.plot([ricavi_genere.iloc[-<span class="hljs-number">2</span>] + <span class="hljs-number">0.15</span>, x_bracket], [y_second - <span class="hljs-number">0.32</span>, y_second - <span class="hljs-number">0.32</span>], color=<span class="hljs-string">&#x27;#555&#x27;</span>, lw=<span class="hljs-number">1.5</span>)

<span class="hljs-comment"># Percentage label</span>
ax.text(x_bracket + <span class="hljs-number">0.15</span>, (y_top + y_second) / <span class="hljs-number">2</span>,
        <span class="hljs-string">f&#x27;<span class="hljs-subst">{top2_pct:<span class="hljs-number">.0</span>f}</span>%\nof total&#x27;</span>, va=<span class="hljs-string">&#x27;center&#x27;</span>, fontsize=<span class="hljs-number">11</span>,
        fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, color=<span class="hljs-string">&#x27;#c0392b&#x27;</span>)

ax.set_title(
    <span class="hljs-string">&#x27;Thriller and Fiction alone account for {:.0f}% of total revenue&#x27;</span>.<span class="hljs-built_in">format</span>(top2_pct),
    fontsize=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>, pad=<span class="hljs-number">15</span>)
ax.xaxis.set_visible(<span class="hljs-literal">False</span>)
<span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;bottom&#x27;</span>, <span class="hljs-string">&#x27;left&#x27;</span>]:
    ax.spines[sp].set_visible(<span class="hljs-literal">False</span>)
ax.tick_params(left=<span class="hljs-literal">False</span>)
ax.set_xlim(<span class="hljs-number">0</span>, ricavi_genere.<span class="hljs-built_in">max</span>() + <span class="hljs-number">2.5</span>)  <span class="hljs-comment"># space for bracket</span>

ax.text(<span class="hljs-number">0.98</span>, <span class="hljs-number">0.02</span>,
        <span class="hljs-string">&#x27;So What? Dependence on 2 genres is a risk.\nDiversify into Fantasy and Young Adult.&#x27;</span>,
        transform=ax.transAxes, fontsize=<span class="hljs-number">9</span>, va=<span class="hljs-string">&#x27;bottom&#x27;</span>, ha=<span class="hljs-string">&#x27;right&#x27;</span>,
        bbox=<span class="hljs-built_in">dict</span>(boxstyle=<span class="hljs-string">&#x27;round,pad=0.5&#x27;</span>, facecolor=<span class="hljs-string">&#x27;#fffde7&#x27;</span>, alpha=<span class="hljs-number">0.8</span>))

plt.tight_layout()
plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-03.png" alt="Notebook output 3"></p>
<h3 id="grouped-bar-chart">Grouped Bar Chart</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># GROUPED BAR: Sales by format and genre (Top 5)</span>
top5_g = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().nlargest(<span class="hljs-number">5</span>).index
vf = (df[df[<span class="hljs-string">&#x27;genere&#x27;</span>].isin(top5_g)].groupby([<span class="hljs-string">&#x27;genere&#x27;</span>,<span class="hljs-string">&#x27;formato&#x27;</span>])[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].<span class="hljs-built_in">sum</span>().reset_index())
piv = vf.pivot(index=<span class="hljs-string">&#x27;genere&#x27;</span>,columns=<span class="hljs-string">&#x27;formato&#x27;</span>,values=<span class="hljs-string">&#x27;copie_vendute&#x27;</span>)
piv = piv.loc[piv.<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">1</span>).sort_values(ascending=<span class="hljs-literal">True</span>).index]
fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">6</span>))
fc = {<span class="hljs-string">&#x27;Print&#x27;</span>:<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,<span class="hljs-string">&#x27;Ebook&#x27;</span>:<span class="hljs-string">&#x27;#3498db&#x27;</span>,<span class="hljs-string">&#x27;Audiobook&#x27;</span>:<span class="hljs-string">&#x27;#e74c3c&#x27;</span>}
x = np.arange(<span class="hljs-built_in">len</span>(piv)); w = <span class="hljs-number">0.25</span>
<span class="hljs-keyword">for</span> i,(fmt,c) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(fc.items()):
    <span class="hljs-keyword">if</span> fmt <span class="hljs-keyword">in</span> piv.columns:
        v = piv[fmt].values/<span class="hljs-number">1000</span>
        ax.barh(x+i*w, v, w, label=fmt, color=c, alpha=<span class="hljs-number">0.85</span>)
ax.set_yticks(x+w); ax.set_yticklabels(piv.index,fontsize=<span class="hljs-number">11</span>)
ax.legend(loc=<span class="hljs-string">&#x27;lower right&#x27;</span>, title=<span class="hljs-string">&#x27;Copies sold&#x27;</span>); ax.xaxis.set_visible(<span class="hljs-literal">False</span>)
ax.set_title(<span class="hljs-string">&quot;Print sells 2x more than ebooks in every genre&quot;</span>, fontsize=<span class="hljs-number">13</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
<span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;bottom&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>]: ax.spines[sp].set_visible(<span class="hljs-literal">False</span>)
ax.tick_params(left=<span class="hljs-literal">False</span>); plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-04.png" alt="Notebook output 4"></p>
<h3 id="lollipop-chart-the-best-data-ink-ratio-of-the-bar-chart">Lollipop Chart: the best data-ink ratio of the bar chart</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># LOLLIPOP: Average rating by genre</span>
rg = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;rating_goodreads&#x27;</span>].mean().sort_values(ascending=<span class="hljs-literal">True</span>)
fig, ax = plt.subplots(figsize=(<span class="hljs-number">10</span>,<span class="hljs-number">6</span>))
mg = df[<span class="hljs-string">&#x27;rating_goodreads&#x27;</span>].mean()
ax.axvline(mg, color=<span class="hljs-string">&#x27;#bdc3c7&#x27;</span>, linestyle=<span class="hljs-string">&#x27;--&#x27;</span>, linewidth=<span class="hljs-number">1</span>, label=<span class="hljs-string">f&#x27;Media: <span class="hljs-subst">{mg:<span class="hljs-number">.2</span>f}</span>&#x27;</span>)
clr = [<span class="hljs-string">&#x27;#27ae60&#x27;</span> <span class="hljs-keyword">if</span> v&gt;=mg <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#e74c3c&#x27;</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> rg.values]
ax.hlines(y=rg.index, xmin=mg, xmax=rg.values, color=clr, linewidth=<span class="hljs-number">2</span>)
ax.scatter(rg.values, rg.index, color=clr, s=<span class="hljs-number">80</span>, zorder=<span class="hljs-number">5</span>)
<span class="hljs-keyword">for</span> i,(g,v) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(rg.items()):
    ax.text(v+(<span class="hljs-number">0.03</span> <span class="hljs-keyword">if</span> v&gt;=mg <span class="hljs-keyword">else</span> -<span class="hljs-number">0.03</span>), i, <span class="hljs-string">f&#x27;<span class="hljs-subst">{v:<span class="hljs-number">.2</span>f}</span>&#x27;</span>, va=<span class="hljs-string">&#x27;center&#x27;</span>,
            ha=<span class="hljs-string">&#x27;left&#x27;</span> <span class="hljs-keyword">if</span> v&gt;=mg <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;right&#x27;</span>, fontsize=<span class="hljs-number">10</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, color=clr[i])
ax.set_title(<span class="hljs-string">&#x27;Fiction and historical essays have the best reviews&#x27;</span>, fontsize=<span class="hljs-number">13</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
<span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;bottom&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>]: ax.spines[sp].set_visible(<span class="hljs-literal">False</span>)
ax.xaxis.set_visible(<span class="hljs-literal">False</span>); ax.tick_params(left=<span class="hljs-literal">False</span>); ax.legend(loc=<span class="hljs-string">&#x27;lower right&#x27;</span>,fontsize=<span class="hljs-number">9</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-05.png" alt="Notebook output 5"></p>
<hr>
<h2 id="distribution-charts">Distribution Charts</h2>
<p>Now let&#39;s first look at the histogram. Specifically, this is shown three times on the same data (cover price) with 5, 20, and 50 bins to demonstrate how the choice of bins changes the perceived message.</p>
<p>Then the box plot, which compares the distribution of prices by genre, ordered by decreasing median.</p>
<p>The violin plot shows the distribution of copies sold (on a log scale) by format, highlighting that audiobooks have a very concentrated distribution.</p>
<p>The KDE overlays the price density curves by publication year (2021-2024), showing the upward shift in recent prices.</p>
<h3 id="histogram-pay-attention-to-the-number-of-bins">Histogram: pay attention to the number of bins!</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># HISTOGRAM: Effect of bins</span>
fig, axes = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">5</span>))
<span class="hljs-keyword">for</span> ax,nb,t <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(axes,[<span class="hljs-number">5</span>,<span class="hljs-number">20</span>,<span class="hljs-number">50</span>],[<span class="hljs-string">&#x27;5 bins: too few&#x27;</span>,<span class="hljs-string">&#x27;20 bins: just right&#x27;</span>,<span class="hljs-string">&#x27;50 bins: too many&#x27;</span>]):
    ax.hist(libri[<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>],bins=nb,color=<span class="hljs-string">&#x27;#3498db&#x27;</span>,edgecolor=<span class="hljs-string">&#x27;white&#x27;</span>,alpha=<span class="hljs-number">0.8</span>)
    ax.set_title(t,fontsize=<span class="hljs-number">11</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>); ax.set_xlabel(<span class="hljs-string">&#x27;Price EUR&#x27;</span>)
    ax.spines[<span class="hljs-string">&#x27;top&#x27;</span>].set_visible(<span class="hljs-literal">False</span>); ax.spines[<span class="hljs-string">&#x27;right&#x27;</span>].set_visible(<span class="hljs-literal">False</span>)
plt.suptitle(<span class="hljs-string">&#x27;The number of bins changes the message!&#x27;</span>,fontsize=<span class="hljs-number">14</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,y=<span class="hljs-number">1.02</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-06.png" alt="Notebook output 6"></p>
<h3 id="box-plot-5-statistics-in-one-go">Box Plot: 5 statistics in one go</h3>
<p>The 5 statistics of the box plot are:</p>
<ul>
<li>Median ‚Äî the central line in the box</li>
<li>Q1 (1st quartile) ‚Äî bottom edge of the box</li>
<li>Q3 (3rd quartile) ‚Äî top edge of the box</li>
<li>Whiskers ‚Äî extend to Q1 ‚àí 1.5√óIQR and Q3 + 1.5√óIQR</li>
<li>Outliers ‚Äî isolated points beyond the whiskers</li>
</ul>
<p>The central box encloses 50% of the data (the IQR, interquartile range)</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># BOX PLOT: Price by genre</span>
om = libri.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>].median().sort_values(ascending=<span class="hljs-literal">False</span>).index
fig, ax = plt.subplots(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">6</span>))
bp = ax.boxplot([libri[libri[<span class="hljs-string">&#x27;genere&#x27;</span>]==g][<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>] <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> om],
    labels=om, patch_artist=<span class="hljs-literal">True</span>, widths=<span class="hljs-number">0.6</span>,
    medianprops=<span class="hljs-built_in">dict</span>(color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span>,linewidth=<span class="hljs-number">2</span>), whiskerprops=<span class="hljs-built_in">dict</span>(color=<span class="hljs-string">&#x27;#7f8c8d&#x27;</span>))
<span class="hljs-keyword">for</span> patch,c <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(bp[<span class="hljs-string">&#x27;boxes&#x27;</span>],[<span class="hljs-string">&#x27;#3498db&#x27;</span>,<span class="hljs-string">&#x27;#2ecc71&#x27;</span>]*<span class="hljs-number">5</span>):
    patch.set_facecolor(c); patch.set_alpha(<span class="hljs-number">0.4</span>)
ax.set_title(<span class="hljs-string">&#x27;Thriller and Fiction have the highest and most variable prices&#x27;</span>,
             fontsize=<span class="hljs-number">13</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
ax.set_ylabel(<span class="hljs-string">&#x27;Price EUR&#x27;</span>); ax.tick_params(axis=<span class="hljs-string">&#x27;x&#x27;</span>,rotation=<span class="hljs-number">30</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-07.png" alt="Notebook output 7"></p>
<p>üì¢ ATTENTION üì¢</p>
<p>Here the colors do not encode any variable; they alternate blue and green merely for &quot;decoration,&quot; but there is no legend or associated meaning.</p>
<p>In fact, they could potentially confuse: the reader asks &quot;what does blue vs. green mean?&quot; and the answer is... nothing.</p>
<p>Here the color should either be uniform (a single gray/blue for all) or encode something useful, for example, highlighting in red the genres with a median above a certain target price, and gray for the others. This way, the color would have a &quot;So What?&quot;.</p>
<blockquote>
<p>This is exactly the principle of part 6 and partly seen before: gray = default, color only for highlighting</p>
</blockquote>
<h3 id="violin-plot">Violin Plot</h3>
<p>The violin plot is a box plot that has learned to speaküòÄ: in addition to the 5 classic statistics, it shows the density of the distribution along its entire height. Where the violin is wider, more data is concentrated there.</p>
<p>In general, when to choose:</p>
<ul>
<li><strong>Box plot</strong>: rapid comparisons between many categories (&gt;5), non-technical audience, limited space. The box plot is immediate and universal.</li>
<li><strong>Violin plot</strong>: when the shape of the distribution is the true story to be told. A bimodal distribution (two humps) is invisible in the box plot but evident in the violin. The same applies to very asymmetric distributions or those with particular concentrations at certain values.</li>
</ul>
<p>Practical rule: if you are comparing medians ‚Üí box plot. If you are comparing how the data behaves ‚Üí violin plot.</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># === CHART 1: Violin Plot ===</span>
<span class="hljs-comment"># Message: the audiobook has a concentrated distribution</span>

fig, ax = plt.subplots(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>))

ds = df.sample(<span class="hljs-number">10000</span>, random_state=<span class="hljs-number">42</span>)
formats = [<span class="hljs-string">&#x27;Cartaceo&#x27;</span>, <span class="hljs-string">&#x27;Ebook&#x27;</span>, <span class="hljs-string">&#x27;Audiolibro&#x27;</span>]

violin_data = []
<span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> formats:
    vals = np.log10(ds[ds[<span class="hljs-string">&#x27;formato&#x27;</span>] == f][<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].clip(<span class="hljs-number">1</span>))
    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vals:
        violin_data.append({<span class="hljs-string">&#x27;format&#x27;</span>: f, <span class="hljs-string">&#x27;log10_copie&#x27;</span>: v})
violin_df = pd.DataFrame(violin_data)

<span class="hljs-comment"># Gray for all, red only for the audiobook (it&#x27;s the message)</span>
palette_violin = {
    <span class="hljs-string">&#x27;Cartaceo&#x27;</span>: <span class="hljs-string">&#x27;#bdc3c7&#x27;</span>,
    <span class="hljs-string">&#x27;Ebook&#x27;</span>: <span class="hljs-string">&#x27;#bdc3c7&#x27;</span>,
    <span class="hljs-string">&#x27;Audiolibro&#x27;</span>: <span class="hljs-string">&#x27;#e74c3c&#x27;</span>
}

sns.violinplot(data=violin_df, x=<span class="hljs-string">&#x27;format&#x27;</span>, y=<span class="hljs-string">&#x27;log10_copie&#x27;</span>,
               palette=palette_violin, inner=<span class="hljs-string">&#x27;quartile&#x27;</span>,
               order=formats, ax=ax, linewidth=<span class="hljs-number">1.2</span>, saturation=<span class="hljs-number">0.8</span>)

<span class="hljs-comment"># Median annotation in readable units</span>
<span class="hljs-keyword">for</span> i, f <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(formats):
    med = np.log10(ds[ds[<span class="hljs-string">&#x27;formato&#x27;</span>] == f][<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].clip(<span class="hljs-number">1</span>)).median()
    label = <span class="hljs-string">f&#x27;<span class="hljs-subst">{<span class="hljs-number">10</span>**med:<span class="hljs-number">.0</span>f}</span> copies&#x27;</span>
    ax.annotate(label, xy=(i, med), xytext=(i + <span class="hljs-number">0.45</span>, med),
                fontsize=<span class="hljs-number">10</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,
                color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span> <span class="hljs-keyword">if</span> f == <span class="hljs-string">&#x27;Audiolibro&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#7f8c8d&#x27;</span>,
                arrowprops=<span class="hljs-built_in">dict</span>(arrowstyle=<span class="hljs-string">&#x27;-&#x27;</span>, color=<span class="hljs-string">&#x27;gray&#x27;</span>, lw=<span class="hljs-number">0.5</span>))

ax.set_title(
    <span class="hljs-string">&quot;The audiobook has a concentrated distribution: few bestsellers&quot;</span>,
    <span class="hljs-comment">#&quot;few bestsellers, many titles with low sales&quot;,</span>
    fontsize=<span class="hljs-number">12</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>, pad=<span class="hljs-number">15</span>)
ax.set_xlabel(<span class="hljs-string">&#x27;&#x27;</span>)
ax.set_ylabel(<span class="hljs-string">&#x27;Copies sold (log10 scale)&#x27;</span>)
ax.spines[<span class="hljs-string">&#x27;top&#x27;</span>].set_visible(<span class="hljs-literal">False</span>)
ax.spines[<span class="hljs-string">&#x27;right&#x27;</span>].set_visible(<span class="hljs-literal">False</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-08.png" alt="Notebook output 8"></p>
<h4 id="why-the-log10-scale">Why the log10 scale?</h4>
<p>Because book sales follow a very asymmetric log-normal distribution. Few bestsellers sell thousands of copies while most titles sell only a few tens.</p>
<p>In a linear scale, the violin would be squashed at the bottom with a long, invisible tail upwards.</p>
<h3 id="kde-plot">KDE Plot</h3>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> stats

fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))

genres_kde = [<span class="hljs-string">&#x27;Poesia&#x27;</span>, <span class="hljs-string">&#x27;Saggistica&#x27;</span>, <span class="hljs-string">&#x27;Fantasy&#x27;</span>, <span class="hljs-string">&#x27;Narrativa&#x27;</span>, <span class="hljs-string">&#x27;Thriller&#x27;</span>]
x_range = np.linspace(<span class="hljs-number">5</span>, <span class="hljs-number">35</span>, <span class="hljs-number">300</span>)

styles = {
    <span class="hljs-string">&#x27;Poesia&#x27;</span>:      {<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#bdc3c7&#x27;</span>, <span class="hljs-string">&#x27;lw&#x27;</span>: <span class="hljs-number">1.5</span>, <span class="hljs-string">&#x27;alpha&#x27;</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;ls&#x27;</span>: <span class="hljs-string">&#x27;:&#x27;</span>},
    <span class="hljs-string">&#x27;Saggistica&#x27;</span>:  {<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#bdc3c7&#x27;</span>, <span class="hljs-string">&#x27;lw&#x27;</span>: <span class="hljs-number">1.5</span>, <span class="hljs-string">&#x27;alpha&#x27;</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;ls&#x27;</span>: <span class="hljs-string">&#x27;--&#x27;</span>},
    <span class="hljs-string">&#x27;Fantasy&#x27;</span>:     {<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#bdc3c7&#x27;</span>, <span class="hljs-string">&#x27;lw&#x27;</span>: <span class="hljs-number">1.5</span>, <span class="hljs-string">&#x27;alpha&#x27;</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;ls&#x27;</span>: <span class="hljs-string">&#x27;-.&#x27;</span>},
    <span class="hljs-string">&#x27;Narrativa&#x27;</span>:   {<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#e67e22&#x27;</span>, <span class="hljs-string">&#x27;lw&#x27;</span>: <span class="hljs-number">3</span>,   <span class="hljs-string">&#x27;alpha&#x27;</span>: <span class="hljs-number">0.9</span>, <span class="hljs-string">&#x27;ls&#x27;</span>: <span class="hljs-string">&#x27;-&#x27;</span>},
    <span class="hljs-string">&#x27;Thriller&#x27;</span>:    {<span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#e74c3c&#x27;</span>, <span class="hljs-string">&#x27;lw&#x27;</span>: <span class="hljs-number">3</span>,   <span class="hljs-string">&#x27;alpha&#x27;</span>: <span class="hljs-number">0.9</span>, <span class="hljs-string">&#x27;ls&#x27;</span>: <span class="hljs-string">&#x27;-&#x27;</span>},
}

<span class="hljs-keyword">for</span> genre <span class="hljs-keyword">in</span> genres_kde:
    subset = libri[libri[<span class="hljs-string">&#x27;genere&#x27;</span>] == genre][<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(subset) &lt; <span class="hljs-number">5</span>:
        <span class="hljs-keyword">continue</span>
    kde = stats.gaussian_kde(subset)
    y_vals = kde(x_range)
    s = styles[genre]
    med = subset.median()

    ax.plot(x_range, y_vals, color=s[<span class="hljs-string">&#x27;color&#x27;</span>], linewidth=s[<span class="hljs-string">&#x27;lw&#x27;</span>],
            alpha=s[<span class="hljs-string">&#x27;alpha&#x27;</span>], linestyle=s[<span class="hljs-string">&#x27;ls&#x27;</span>],
            label=<span class="hljs-string">f&#x27;<span class="hljs-subst">{genre}</span> (EUR <span class="hljs-subst">{med:<span class="hljs-number">.0</span>f}</span>)&#x27;</span>)

    ax.vlines(med, <span class="hljs-number">0</span>, kde(med)[<span class="hljs-number">0</span>], color=s[<span class="hljs-string">&#x27;color&#x27;</span>],
              linewidth=<span class="hljs-number">1</span>, alpha=<span class="hljs-number">0.4</span>, linestyle=s[<span class="hljs-string">&#x27;ls&#x27;</span>])

ax.yaxis.set_visible(<span class="hljs-literal">False</span>)
<span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;left&#x27;</span>, <span class="hljs-string">&#x27;top&#x27;</span>, <span class="hljs-string">&#x27;right&#x27;</span>]:
    ax.spines[sp].set_visible(<span class="hljs-literal">False</span>)

ax.set_xlabel(<span class="hljs-string">&#x27;Cover price (EUR)&#x27;</span>, fontsize=<span class="hljs-number">11</span>)
ax.set_xlim(<span class="hljs-number">5</span>, <span class="hljs-number">35</span>)
ax.legend(loc=<span class="hljs-string">&#x27;center left&#x27;</span>, bbox_to_anchor=(<span class="hljs-number">1.02</span>, <span class="hljs-number">0.5</span>),
          fontsize=<span class="hljs-number">10</span>, frameon=<span class="hljs-literal">False</span>,
          title=<span class="hljs-string">&#x27;Genre (median)&#x27;</span>, title_fontsize=<span class="hljs-number">10</span>)
ax.set_title(
    <span class="hljs-string">&#x27;Thriller and Fiction in the high range, Poetry and Non-fiction in the low range&#x27;</span>,
    fontsize=<span class="hljs-number">13</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>, pad=<span class="hljs-number">15</span>)

<span class="hljs-comment"># Caption: explains how to read the chart</span>
fig.text(<span class="hljs-number">0.02</span>, -<span class="hljs-number">0.02</span>,
         <span class="hljs-string">&#x27;Each curve shows how cover prices are distributed by genre. &#x27;</span>
         <span class="hljs-string">&#x27;The higher the curve, the more books are concentrated at that price. &#x27;</span>
         <span class="hljs-string">&#x27;Vertical lines indicate the median.&#x27;</span>,
         fontsize=<span class="hljs-number">9</span>, color=<span class="hljs-string">&#x27;#7f8c8d&#x27;</span>, style=<span class="hljs-string">&#x27;italic&#x27;</span>, va=<span class="hljs-string">&#x27;top&#x27;</span>)

plt.tight_layout()
plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-09.png" alt="Notebook output 9"></p>
<hr>
<h2 id="relationship-charts">Relationship Charts</h2>
<p>Now we will see:</p>
<ul>
<li><p>scatter plot, mapping Goodreads rating (x) vs total revenue (y) for each book, with color = genre and point size = number of reviews, showing that a high rating does not guarantee high revenue.</p>
</li>
<li><p>The heatmap shows the genre √ó month matrix with intensity normalized per row, with a rectangle highlighting the December column.</p>
</li>
<li><p>The correlation matrix uses a triangular mask and a divergent RdBu palette, revealing that the number of reviews is the best predictor of revenue.</p>
</li>
</ul>
<h3 id="scatter-plot">Scatter Plot</h3>
<p>The scatter plot maps the relationship between two continuous variables. Each point is an observation (in this case, a book) and its position on the plane reveals whether a correlation exists.
In this example, we want to answer a common question in the publishing industry: does a high Goodreads rating translate into high revenue?</p>
<p>The answer is not obvious. A book can have 4.8 stars and be read by 30 people, or 3.5 stars and sell hundreds of thousands of copies. The discriminating factor is not perceived quality but visibility, approximated by the number of reviews.</p>
<p>Design choices made by me:</p>
<ul>
<li>X-axis = Goodreads rating, Y-axis = total revenue in EUR</li>
<li>Color = number of reviews, grouped into 4 bands $(&lt; 50, 50-200, 200-1K, &gt; 1K)$ with a sequential gray ‚Üí red palette. This is the real driver and should stand out.</li>
<li>Uniform size: let&#39;s remember that the human eye is bad at comparing areas (see Part 4: visual properties). It&#39;s better to use color and divide the classes into 4 bands, with a clear ordering (few = gray, many = red).</li>
<li>Genre in hover, not in the legend: the chart&#39;s message is not about genres. Using 10 colors per genre would have hidden the main pattern. The genre remains available on hover for those who want to explore.</li>
<li>Interactive Plotly: allows hovering over each point to see genre, price, copies, and reviews. Exploration replaces the crowded legend. However, I consider this choice to be of last importance compared to the others made.</li>
</ul>
<pre><code class="hljs language-python">ls = (df.groupby([<span class="hljs-string">&#x27;libro_id&#x27;</span>,<span class="hljs-string">&#x27;genere&#x27;</span>,<span class="hljs-string">&#x27;rating_goodreads&#x27;</span>,<span class="hljs-string">&#x27;n_recensioni&#x27;</span>,<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>])
      .agg(ricavo_totale=(<span class="hljs-string">&#x27;ricavo&#x27;</span>,<span class="hljs-string">&#x27;sum&#x27;</span>), copie_totali=(<span class="hljs-string">&#x27;copie_vendute&#x27;</span>,<span class="hljs-string">&#x27;sum&#x27;</span>)).reset_index())

ls[<span class="hljs-string">&#x27;fascia_recensioni&#x27;</span>] = pd.cut(
    ls[<span class="hljs-string">&#x27;n_recensioni&#x27;</span>],
    bins=[<span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">200</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">10000</span>],
    labels=[<span class="hljs-string">&#x27;&lt; 50&#x27;</span>, <span class="hljs-string">&#x27;50-200&#x27;</span>, <span class="hljs-string">&#x27;200-1K&#x27;</span>, <span class="hljs-string">&#x27;&gt; 1K&#x27;</span>]
)

fig = px.scatter(
    ls,
    x=<span class="hljs-string">&#x27;rating_goodreads&#x27;</span>,
    y=<span class="hljs-string">&#x27;ricavo_totale&#x27;</span>,
    color=<span class="hljs-string">&#x27;fascia_recensioni&#x27;</span>,
    color_discrete_map={
        <span class="hljs-string">&#x27;&lt; 50&#x27;</span>:    <span class="hljs-string">&#x27;#d5d8dc&#x27;</span>,
        <span class="hljs-string">&#x27;50-200&#x27;</span>:  <span class="hljs-string">&#x27;#aeb6bf&#x27;</span>,
        <span class="hljs-string">&#x27;200-1K&#x27;</span>:  <span class="hljs-string">&#x27;#e67e22&#x27;</span>,
        <span class="hljs-string">&#x27;&gt; 1K&#x27;</span>:    <span class="hljs-string">&#x27;#e74c3c&#x27;</span>,
    },
    category_orders={<span class="hljs-string">&#x27;fascia_recensioni&#x27;</span>: [<span class="hljs-string">&#x27;&lt; 50&#x27;</span>, <span class="hljs-string">&#x27;50-200&#x27;</span>, <span class="hljs-string">&#x27;200-1K&#x27;</span>, <span class="hljs-string">&#x27;&gt; 1K&#x27;</span>]},
    hover_data={
        <span class="hljs-string">&#x27;genere&#x27;</span>: <span class="hljs-literal">True</span>,
        <span class="hljs-string">&#x27;n_recensioni&#x27;</span>: <span class="hljs-literal">True</span>,
        <span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>: <span class="hljs-string">&#x27;:.2f&#x27;</span>,
        <span class="hljs-string">&#x27;copie_totali&#x27;</span>: <span class="hljs-string">&#x27;:,.0f&#x27;</span>,
        <span class="hljs-string">&#x27;ricavo_totale&#x27;</span>: <span class="hljs-string">&#x27;:,.0f&#x27;</span>,
        <span class="hljs-string">&#x27;rating_goodreads&#x27;</span>: <span class="hljs-string">&#x27;:.1f&#x27;</span>,
        <span class="hljs-string">&#x27;fascia_recensioni&#x27;</span>: <span class="hljs-literal">False</span>,
    },
    labels={
        <span class="hljs-string">&#x27;rating_goodreads&#x27;</span>: <span class="hljs-string">&#x27;Rating Goodreads&#x27;</span>,
        <span class="hljs-string">&#x27;ricavo_totale&#x27;</span>: <span class="hljs-string">&#x27;Total Revenue (EUR)&#x27;</span>,
        <span class="hljs-string">&#x27;fascia_recensioni&#x27;</span>: <span class="hljs-string">&#x27;No. of Reviews&#x27;</span>,
        <span class="hljs-string">&#x27;genere&#x27;</span>: <span class="hljs-string">&#x27;Genre&#x27;</span>,
        <span class="hljs-string">&#x27;n_recensioni&#x27;</span>: <span class="hljs-string">&#x27;Reviews&#x27;</span>,
        <span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>: <span class="hljs-string">&#x27;Price&#x27;</span>,
        <span class="hljs-string">&#x27;copie_totali&#x27;</span>: <span class="hljs-string">&#x27;Copies sold&#x27;</span>,
    },
    opacity=<span class="hljs-number">0.6</span>,
)

fig.update_traces(marker=<span class="hljs-built_in">dict</span>(size=<span class="hljs-number">8</span>, line=<span class="hljs-built_in">dict</span>(width=<span class="hljs-number">0</span>)))

fig.update_layout(
    title=<span class="hljs-built_in">dict</span>(
        text=(
            <span class="hljs-string">&#x27;&lt;b&gt;High rating does not guarantee revenue: &#x27;</span>
            <span class="hljs-string">&#x27;reviews are needed&lt;/b&gt;&#x27;</span>
            <span class="hljs-string">&#x27;&lt;br&gt;&lt;sup&gt;Each point = a book. &#x27;</span>
            <span class="hljs-string">&#x27;Color = review volume. Hover for details.&lt;/sup&gt;&#x27;</span>
        ),
        x=<span class="hljs-number">0</span>, xanchor=<span class="hljs-string">&#x27;left&#x27;</span>,
    ),
    template=<span class="hljs-string">&#x27;plotly_white&#x27;</span>,
    height=<span class="hljs-number">550</span>, width=<span class="hljs-number">900</span>,
    legend=<span class="hljs-built_in">dict</span>(
        title=<span class="hljs-string">&#x27;No. of Reviews&#x27;</span>,
        orientation=<span class="hljs-string">&#x27;v&#x27;</span>,
        yanchor=<span class="hljs-string">&#x27;top&#x27;</span>, y=<span class="hljs-number">0.98</span>,
        xanchor=<span class="hljs-string">&#x27;left&#x27;</span>, x=<span class="hljs-number">1.02</span>,
        font=<span class="hljs-built_in">dict</span>(size=<span class="hljs-number">11</span>),
    ),
    xaxis=<span class="hljs-built_in">dict</span>(dtick=<span class="hljs-number">0.5</span>),
)
fig.show()</code></pre><h3 id="heatmap-seasonality-by-genre">Heatmap: Seasonality by genre</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># HEATMAP: Vendite per genere e mese</span>
hd = df.groupby([df[<span class="hljs-string">&#x27;data&#x27;</span>].dt.month_name(),<span class="hljs-string">&#x27;genere&#x27;</span>])[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].<span class="hljs-built_in">sum</span>().reset_index()
hd.columns = [<span class="hljs-string">&#x27;mese&#x27;</span>,<span class="hljs-string">&#x27;genere&#x27;</span>,<span class="hljs-string">&#x27;copie&#x27;</span>]
mo = [<span class="hljs-string">&#x27;January&#x27;</span>,<span class="hljs-string">&#x27;February&#x27;</span>,<span class="hljs-string">&#x27;March&#x27;</span>,<span class="hljs-string">&#x27;April&#x27;</span>,<span class="hljs-string">&#x27;May&#x27;</span>,<span class="hljs-string">&#x27;June&#x27;</span>,<span class="hljs-string">&#x27;July&#x27;</span>,<span class="hljs-string">&#x27;August&#x27;</span>,<span class="hljs-string">&#x27;September&#x27;</span>,<span class="hljs-string">&#x27;October&#x27;</span>,<span class="hljs-string">&#x27;November&#x27;</span>,<span class="hljs-string">&#x27;December&#x27;</span>]
ml = [<span class="hljs-string">&#x27;Jan&#x27;</span>,<span class="hljs-string">&#x27;Feb&#x27;</span>,<span class="hljs-string">&#x27;Mar&#x27;</span>,<span class="hljs-string">&#x27;Apr&#x27;</span>,<span class="hljs-string">&#x27;May&#x27;</span>,<span class="hljs-string">&#x27;Jun&#x27;</span>,<span class="hljs-string">&#x27;Jul&#x27;</span>,<span class="hljs-string">&#x27;Aug&#x27;</span>,<span class="hljs-string">&#x27;Sep&#x27;</span>,<span class="hljs-string">&#x27;Oct&#x27;</span>,<span class="hljs-string">&#x27;Nov&#x27;</span>,<span class="hljs-string">&#x27;Dec&#x27;</span>]
ph = hd.pivot(index=<span class="hljs-string">&#x27;genere&#x27;</span>,columns=<span class="hljs-string">&#x27;mese&#x27;</span>,values=<span class="hljs-string">&#x27;copie&#x27;</span>)[mo]
pn = ph.div(ph.<span class="hljs-built_in">max</span>(axis=<span class="hljs-number">1</span>),axis=<span class="hljs-number">0</span>)
fig, ax = plt.subplots(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">7</span>))
sns.heatmap(pn, annot=<span class="hljs-literal">False</span>, cmap=<span class="hljs-string">&#x27;YlOrRd&#x27;</span>, linewidths=<span class="hljs-number">0.5</span>, xticklabels=ml, ax=ax)
ax.set_title(<span class="hljs-string">&quot;December is the golden month for ALL genres&quot;</span>,fontsize=<span class="hljs-number">12</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
ax.set_ylabel(<span class="hljs-string">&#x27;&#x27;</span>); ax.set_xlabel(<span class="hljs-string">&#x27;&#x27;</span>)
<span class="hljs-keyword">from</span> matplotlib.patches <span class="hljs-keyword">import</span> Rectangle
ax.add_patch(Rectangle((<span class="hljs-number">11</span>,<span class="hljs-number">0</span>),<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(pn),linewidth=<span class="hljs-number">3</span>,edgecolor=<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,facecolor=<span class="hljs-string">&#x27;none&#x27;</span>))
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-10.png" alt="Notebook output 10"></p>
<h3 id="correlation-matrix">Correlation matrix</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># CORRELATION MATRIX</span>
lf = df.groupby(<span class="hljs-string">&#x27;libro_id&#x27;</span>).agg(ricavo_totale=(<span class="hljs-string">&#x27;ricavo&#x27;</span>,<span class="hljs-string">&#x27;sum&#x27;</span>),copie_totali=(<span class="hljs-string">&#x27;copie_vendute&#x27;</span>,<span class="hljs-string">&#x27;sum&#x27;</span>)).reset_index().merge(libri,on=<span class="hljs-string">&#x27;libro_id&#x27;</span>)
nc = [<span class="hljs-string">&#x27;prezzo_copertina&#x27;</span>,<span class="hljs-string">&#x27;pagine&#x27;</span>,<span class="hljs-string">&#x27;rating_goodreads&#x27;</span>,<span class="hljs-string">&#x27;n_recensioni&#x27;</span>,<span class="hljs-string">&#x27;ricavo_totale&#x27;</span>,<span class="hljs-string">&#x27;copie_totali&#x27;</span>]
li = [<span class="hljs-string">&#x27;Price&#x27;</span>,<span class="hljs-string">&#x27;Pages&#x27;</span>,<span class="hljs-string">&#x27;Rating&#x27;</span>,<span class="hljs-string">&#x27;N.Reviews&#x27;</span>,<span class="hljs-string">&#x27;Revenue&#x27;</span>,<span class="hljs-string">&#x27;Copies&#x27;</span>]
corr = lf[nc].corr()
mask = np.triu(np.ones_like(corr,dtype=<span class="hljs-built_in">bool</span>))
fig, ax = plt.subplots(figsize=(<span class="hljs-number">9</span>,<span class="hljs-number">7</span>))
sns.heatmap(corr,mask=mask,annot=<span class="hljs-literal">True</span>,fmt=<span class="hljs-string">&#x27;.2f&#x27;</span>,cmap=<span class="hljs-string">&#x27;RdBu_r&#x27;</span>,center=<span class="hljs-number">0</span>,vmin=-<span class="hljs-number">1</span>,vmax=<span class="hljs-number">1</span>,square=<span class="hljs-literal">True</span>,
            xticklabels=li,yticklabels=li,linewidths=<span class="hljs-number">1</span>,ax=ax)
ax.set_title(<span class="hljs-string">&#x27;Number of reviews is the best predictor of revenue, not rating&#x27;</span>,fontsize=<span class="hljs-number">12</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-11.png" alt="Notebook output 11"></p>
<hr>
<h2 id="composition-charts">Composition charts</h2>
<p>In this section we see:</p>
<ul>
<li>the 100% horizontal stacked bar chart, which shows the share of the 3 formats for each genre, highlighting that Sci-Fi and Fantasy lead the digital sector.</li>
<li>The interactive Plotly treemap visualizes the genre ‚Üí series hierarchy with color proportional to revenue.</li>
<li>Finally, a critical note on the pie chart with a comparison: on the left, a 2-slice pie chart that works (Print vs Digital), on the right, the same with 10 genres that becomes unreadable.</li>
</ul>
<h3 id="stacked-bar-100">Stacked Bar 100%</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># STACKED BAR 100%: Format share by genre</span>
sd = df.groupby([<span class="hljs-string">&#x27;genere&#x27;</span>,<span class="hljs-string">&#x27;formato&#x27;</span>])[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().reset_index()
sp = sd.pivot(index=<span class="hljs-string">&#x27;genere&#x27;</span>,columns=<span class="hljs-string">&#x27;formato&#x27;</span>,values=<span class="hljs-string">&#x27;ricavo&#x27;</span>)
spct = sp.div(sp.<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">1</span>),axis=<span class="hljs-number">0</span>)*<span class="hljs-number">100</span>
spct = spct.sort_values(<span class="hljs-string">&#x27;Ebook&#x27;</span>,ascending=<span class="hljs-literal">True</span>)
fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">6</span>))
fc = {<span class="hljs-string">&#x27;Print&#x27;</span>:<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,<span class="hljs-string">&#x27;Ebook&#x27;</span>:<span class="hljs-string">&#x27;#3498db&#x27;</span>,<span class="hljs-string">&#x27;Audiobook&#x27;</span>:<span class="hljs-string">&#x27;#e74c3c&#x27;</span>}
bot = np.zeros(<span class="hljs-built_in">len</span>(spct))
<span class="hljs-keyword">for</span> fmt <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;Print&#x27;</span>,<span class="hljs-string">&#x27;Ebook&#x27;</span>,<span class="hljs-string">&#x27;Audiobook&#x27;</span>]:
    v = spct[fmt].values
    ax.barh(spct.index,v,left=bot,label=fmt,color=fc[fmt],height=<span class="hljs-number">0.65</span>,alpha=<span class="hljs-number">0.85</span>)
    <span class="hljs-keyword">for</span> i,(val,b) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(v,bot)):
        <span class="hljs-keyword">if</span> val&gt;<span class="hljs-number">10</span>: ax.text(b+val/<span class="hljs-number">2</span>,i,<span class="hljs-string">f&#x27;<span class="hljs-subst">{val:<span class="hljs-number">.1</span>f}</span>%&#x27;</span>,ha=<span class="hljs-string">&#x27;center&#x27;</span>,va=<span class="hljs-string">&#x27;center&#x27;</span>,fontsize=<span class="hljs-number">9</span>,color=<span class="hljs-string">&#x27;white&#x27;</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>)
    bot += v
ax.set_title(<span class="hljs-string">&#x27;Sci-Fi and Fantasy lead the digital transition&#x27;</span>,fontsize=<span class="hljs-number">12</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
ax.legend(loc=<span class="hljs-string">&#x27;lower right&#x27;</span>); ax.set_xlim(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-12.png" alt="Notebook output 12"></p>
<h3 id="treemap-interactive-plotly">Treemap (Interactive Plotly)</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># TREEMAP</span>
td = df.groupby([<span class="hljs-string">&#x27;genere&#x27;</span>,<span class="hljs-string">&#x27;collana&#x27;</span>])[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().reset_index()
fig = px.treemap(td, path=[<span class="hljs-string">&#x27;genere&#x27;</span>,<span class="hljs-string">&#x27;collana&#x27;</span>], values=<span class="hljs-string">&#x27;ricavo&#x27;</span>, color=<span class="hljs-string">&#x27;ricavo&#x27;</span>, color_continuous_scale=<span class="hljs-string">&#x27;RdYlBu_r&#x27;</span>,
                 title=<span class="hljs-string">&#x27;&lt;b&gt;Revenue Map: Genre &gt; Series&lt;/b&gt;&#x27;</span>)
fig.update_layout(margin=<span class="hljs-built_in">dict</span>(t=<span class="hljs-number">50</span>,l=<span class="hljs-number">10</span>,r=<span class="hljs-number">10</span>,b=<span class="hljs-number">10</span>), height=<span class="hljs-number">500</span>)
fig.show()</code></pre><h3 id="note-on-the-pie-chart">Note on the Pie Chart</h3>
<p>The <strong>pie chart</strong> is the most criticized chart. The human eye is bad at comparing angles.</p>
<p><strong>Rule:</strong> If you could use a bar chart instead, use the bar chart. Acceptable only with 2-3 categories and a dominant one.</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># Pie: when it works and when it doesn&#x27;t</span>
fig, (ax1,ax2) = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">5</span>))
ax1.pie([<span class="hljs-number">55</span>,<span class="hljs-number">45</span>],labels=[<span class="hljs-string">&#x27;Print&#x27;</span>,<span class="hljs-string">&#x27;Digital&#x27;</span>],autopct=<span class="hljs-string">&#x27;%1.0f%%&#x27;</span>,colors=[<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,<span class="hljs-string">&#x27;#3498db&#x27;</span>],startangle=<span class="hljs-number">90</span>,textprops={<span class="hljs-string">&#x27;fontsize&#x27;</span>:<span class="hljs-number">12</span>})
ax1.set_title(<span class="hljs-string">&#x27;OK: 2 categories, clear&#x27;</span>,fontsize=<span class="hljs-number">10</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,pad=<span class="hljs-number">15</span>)
rgp = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().sort_values()
ax2.pie(rgp.values,labels=rgp.index,autopct=<span class="hljs-string">&#x27;%1.0f%%&#x27;</span>,startangle=<span class="hljs-number">90</span>,textprops={<span class="hljs-string">&#x27;fontsize&#x27;</span>:<span class="hljs-number">8</span>})
ax2.set_title(<span class="hljs-string">&#x27;NO: 10 categories, unreadable!&#x27;</span>,fontsize=<span class="hljs-number">10</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,pad=<span class="hljs-number">15</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-13.png" alt="Notebook output 13"></p>
<hr>
<h2 id="time-series-charts">Time series charts</h2>
<p>The line chart plots monthly sales by format with different styles (audiobook in red dashed line), semi-transparent yellow bands over Decembers, and a title announcing the tripling of audiobooks.</p>
<p>The stacked area chart shows the evolution of cumulative revenue for the top 5 genres, making the growing contribution of Thriller visible.</p>
<h3 id="line-chart">Line Chart</h3>
<pre><code class="hljs language-routeros">
```python
<span class="hljs-comment"># LINE CHART: Vendite mensili per formato</span>
vm = df.groupby([df[<span class="hljs-string">&#x27;data&#x27;</span>],<span class="hljs-string">&#x27;formato&#x27;</span>])[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].sum().reset_index()
fig, ax = plt.subplots(figsize=(14,6))
<span class="hljs-keyword">for</span> fmt,sty <span class="hljs-keyword">in</span> [(<span class="hljs-string">&#x27;Cartaceo&#x27;</span>,{<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,<span class="hljs-string">&#x27;lw&#x27;</span>:2.5,<span class="hljs-string">&#x27;ls&#x27;</span>:<span class="hljs-string">&#x27;-&#x27;</span>}),
                (<span class="hljs-string">&#x27;Ebook&#x27;</span>,{<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#3498db&#x27;</span>,<span class="hljs-string">&#x27;lw&#x27;</span>:2.5,<span class="hljs-string">&#x27;ls&#x27;</span>:<span class="hljs-string">&#x27;-&#x27;</span>}),
                (<span class="hljs-string">&#x27;Audiolibro&#x27;</span>,{<span class="hljs-string">&#x27;color&#x27;</span>:<span class="hljs-string">&#x27;#e74c3c&#x27;</span>,<span class="hljs-string">&#x27;lw&#x27;</span>:2.5,<span class="hljs-string">&#x27;ls&#x27;</span>:<span class="hljs-string">&#x27;--&#x27;</span>})]:
    s = vm[vm[<span class="hljs-string">&#x27;formato&#x27;</span>]==fmt]
    ax.plot(s[<span class="hljs-string">&#x27;data&#x27;</span>],s[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>]/1000,<span class="hljs-attribute">label</span>=fmt,color=sty[<span class="hljs-string">&#x27;color&#x27;</span>],<span class="hljs-attribute">linewidth</span>=sty[<span class="hljs-string">&#x27;lw&#x27;</span>],<span class="hljs-attribute">linestyle</span>=sty[<span class="hljs-string">&#x27;ls&#x27;</span>])
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> [2023,2024]:
    ax.axvspan(pd.Timestamp(f<span class="hljs-string">&#x27;{y}-12-01&#x27;</span>),pd.Timestamp(f<span class="hljs-string">&#x27;{y}-12-31&#x27;</span>),<span class="hljs-attribute">alpha</span>=0.1,color=&#x27;#f39c12&#x27;,label=&#x27;_nolegend_&#x27;)
ax.set_title(<span class="hljs-string">&quot;L&#x27;audiolibro triplica in 2 anni: il futuro e&#x27; multiformat&quot;</span>,<span class="hljs-attribute">fontsize</span>=12,fontweight=&#x27;bold&#x27;,loc=&#x27;left&#x27;,pad=15)
ax.set_ylabel(<span class="hljs-string">&#x27;Copie (migliaia)&#x27;</span>); ax.legend(<span class="hljs-attribute">loc</span>=<span class="hljs-string">&#x27;upper left&#x27;</span>)
ax.xaxis.set_major_formatter(mdates.DateFormatter(<span class="hljs-string">&#x27;%b %Y&#x27;</span>)); ax.xaxis.set_major_locator(mdates.MonthLocator(<span class="hljs-attribute">interval</span>=3))
plt.xticks(<span class="hljs-attribute">rotation</span>=30); plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-14.png" alt="Notebook output 14"></p>
<h3 id="stacked-area-chart">Stacked Area Chart</h3>
<pre><code class="hljs language-python"><span class="hljs-comment"># STACKED AREA: Ricavi per genere Top 5</span>
t5 = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().nlargest(<span class="hljs-number">5</span>).index
rm = (df[df[<span class="hljs-string">&#x27;genere&#x27;</span>].isin(t5)].groupby([df[<span class="hljs-string">&#x27;data&#x27;</span>],<span class="hljs-string">&#x27;genere&#x27;</span>])[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().reset_index()
      .pivot(index=<span class="hljs-string">&#x27;data&#x27;</span>,columns=<span class="hljs-string">&#x27;genere&#x27;</span>,values=<span class="hljs-string">&#x27;ricavo&#x27;</span>).fillna(<span class="hljs-number">0</span>)/<span class="hljs-number">1000</span>)
fig, ax = plt.subplots(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">6</span>))
ax.stackplot(rm.index,[rm[g] <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> rm.columns],labels=rm.columns,
             colors=[<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,<span class="hljs-string">&#x27;#e74c3c&#x27;</span>,<span class="hljs-string">&#x27;#3498db&#x27;</span>,<span class="hljs-string">&#x27;#27ae60&#x27;</span>,<span class="hljs-string">&#x27;#f39c12&#x27;</span>],alpha=<span class="hljs-number">0.7</span>)
ax.set_title(<span class="hljs-string">&#x27;Ricavi in crescita, trainati dal Thriller&#x27;</span>,fontsize=<span class="hljs-number">12</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
ax.set_ylabel(<span class="hljs-string">&#x27;Ricavi (EUR K)&#x27;</span>); ax.legend(loc=<span class="hljs-string">&#x27;upper left&#x27;</span>)
ax.xaxis.set_major_formatter(mdates.DateFormatter(<span class="hljs-string">&#x27;%b %Y&#x27;</span>)); ax.xaxis.set_major_locator(mdates.MonthLocator(interval=<span class="hljs-number">3</span>))
plt.xticks(rotation=<span class="hljs-number">30</span>); plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-15.png" alt="Notebook output 15"></p>
<hr>
<h1 id="fundamental-techniques">Fundamental techniques</h1>
<h2 id="the-power-of-annotations">The power of annotations</h2>
<p>A dramatic &quot;before/after&quot; comparison can be made on the same line chart of quarterly revenues.</p>
<ul>
<li>Above: the generic chart with descriptive title &quot;Quarterly Revenues (EUR M)&quot;.</li>
<li>Below: the same data with a dashed green target line, green/red colored points above/below target, annotated arrows on peak and minimum, a green box in the top right with the 3 recommended actions, and a title that says &quot;Anti-seasonality strategies are needed for Q1&quot;.</li>
</ul>
<pre><code class="hljs language-python"><span class="hljs-comment"># ANNOTATIONS: Before and After</span>
rq = df.groupby(df[<span class="hljs-string">&#x27;data&#x27;</span>].dt.to_period(<span class="hljs-string">&#x27;Q&#x27;</span>))[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>()/<span class="hljs-number">1e6</span>
rq.index = rq.index.to_timestamp()
fig, (ax1,ax2) = plt.subplots(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">10</span>),sharex=<span class="hljs-literal">True</span>)

ax1.plot(rq.index,rq.values,<span class="hljs-string">&#x27;o-&#x27;</span>,color=<span class="hljs-string">&#x27;#3498db&#x27;</span>,linewidth=<span class="hljs-number">2</span>)
ax1.set_title(<span class="hljs-string">&#x27;Ricavi Trimestrali (EUR M)&#x27;</span>,fontsize=<span class="hljs-number">13</span>); ax1.set_ylabel(<span class="hljs-string">&#x27;EUR M&#x27;</span>)
ax1.text(<span class="hljs-number">0.5</span>,-<span class="hljs-number">0.05</span>,<span class="hljs-string">&#x27;BEFORE: informative but not actionable&#x27;</span>,transform=ax1.transAxes,ha=<span class="hljs-string">&#x27;center&#x27;</span>,fontsize=<span class="hljs-number">11</span>,color=<span class="hljs-string">&#x27;red&#x27;</span>)

ax2.plot(rq.index,rq.values,<span class="hljs-string">&#x27;o-&#x27;</span>,color=<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,linewidth=<span class="hljs-number">2.5</span>)
tgt = rq.mean()*<span class="hljs-number">1.1</span>
ax2.axhline(tgt,color=<span class="hljs-string">&#x27;#27ae60&#x27;</span>,linestyle=<span class="hljs-string">&#x27;--&#x27;</span>,linewidth=<span class="hljs-number">1.5</span>,alpha=<span class="hljs-number">0.7</span>)
ax2.text(rq.index[-<span class="hljs-number">1</span>],tgt+<span class="hljs-number">0.1</span>,<span class="hljs-string">f&#x27;Target: EUR <span class="hljs-subst">{tgt:<span class="hljs-number">.1</span>f}</span>M&#x27;</span>,fontsize=<span class="hljs-number">9</span>,color=<span class="hljs-string">&#x27;#27ae60&#x27;</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,ha=<span class="hljs-string">&#x27;right&#x27;</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(rq)):
    c = <span class="hljs-string">&#x27;#27ae60&#x27;</span> <span class="hljs-keyword">if</span> rq.values[i]&gt;=tgt <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#e74c3c&#x27;</span>
    ax2.plot(rq.index[i],rq.values[i],<span class="hljs-string">&#x27;o&#x27;</span>,color=c,markersize=<span class="hljs-number">10</span>,zorder=<span class="hljs-number">5</span>)
ax2.annotate(<span class="hljs-string">f&#x27;Peak: EUR <span class="hljs-subst">{rq.<span class="hljs-built_in">max</span>():<span class="hljs-number">.1</span>f}</span>M&#x27;</span>,xy=(rq.idxmax(),rq.<span class="hljs-built_in">max</span>()),
             xytext=(rq.idxmax()-pd.DateOffset(months=<span class="hljs-number">3</span>),rq.<span class="hljs-built_in">max</span>()+<span class="hljs-number">0.5</span>),
             arrowprops=<span class="hljs-built_in">dict</span>(arrowstyle=<span class="hljs-string">&#x27;-&gt;&#x27;</span>,color=<span class="hljs-string">&#x27;#27ae60&#x27;</span>),fontsize=<span class="hljs-number">10</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,color=<span class="hljs-string">&#x27;#27ae60&#x27;</span>)
ax2.annotate(<span class="hljs-string">f&#x27;Minimum: EUR <span class="hljs-subst">{rq.<span class="hljs-built_in">min</span>():<span class="hljs-number">.1</span>f}</span>M&#x27;</span>,xy=(rq.idxmin(),rq.<span class="hljs-built_in">min</span>()),
             xytext=(rq.idxmin()+pd.DateOffset(months=<span class="hljs-number">2</span>),rq.<span class="hljs-built_in">min</span>()-<span class="hljs-number">0.1</span>),
             arrowprops=<span class="hljs-built_in">dict</span>(arrowstyle=<span class="hljs-string">&#x27;-&gt;&#x27;</span>,color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span>),fontsize=<span class="hljs-number">10</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span>)
ax2.set_title(<span class="hljs-string">&#x27;Anti-seasonality strategies are needed for Q1&#x27;</span>,fontsize=<span class="hljs-number">13</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
ax2.set_ylabel(<span class="hljs-string">&#x27;EUR M&#x27;</span>)
ax2.text(<span class="hljs-number">0.9</span>,<span class="hljs-number">0.95</span>,<span class="hljs-string">&#x27;ACTION: Q1 Promotions, thriller releases\n moved up to January&#x27;</span>,
         transform=ax2.transAxes,fontsize=<span class="hljs-number">9</span>,va=<span class="hljs-string">&#x27;top&#x27;</span>,ha=<span class="hljs-string">&#x27;right&#x27;</span>,
         bbox=<span class="hljs-built_in">dict</span>(boxstyle=<span class="hljs-string">&#x27;round,pad=0.5&#x27;</span>,facecolor=<span class="hljs-string">&#x27;#e8f5e9&#x27;</span>,alpha=<span class="hljs-number">0.9</span>))
ax2.text(<span class="hljs-number">0.5</span>,-<span class="hljs-number">0.1</span>,<span class="hljs-string">&#x27;AFTER: same data, tells story + suggests action&#x27;</span>,transform=ax2.transAxes,ha=<span class="hljs-string">&#x27;center&#x27;</span>,fontsize=<span class="hljs-number">11</span>,color=<span class="hljs-string">&#x27;green&#x27;</span>)
<span class="hljs-keyword">for</span> ax <span class="hljs-keyword">in</span> [ax1,ax2]: ax.spines[<span class="hljs-string">&#x27;top&#x27;</span>].set_visible(<span class="hljs-literal">False</span>); ax.spines[<span class="hljs-string">&#x27;right&#x27;</span>].set_visible(<span class="hljs-literal">False</span>)
plt.tight_layout(); plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-16.png" alt="Notebook output 16"></p>
<h2 id="color-in-data-visualization">Color in Data Visualization</h2>
<figure class="table-wrapper" data-enhanced-table><div class="table-wrapper__scroll"><table>
<thead>
<tr>
<th>Type</th>
<th>Usage</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Sequential</strong></td>
<td>Low ‚Üí High</td>
</tr>
<tr>
<td><strong>Diverging</strong></td>
<td>Negative ‚Üê Neutral ‚Üí Positive</td>
</tr>
<tr>
<td><strong>Categorical</strong></td>
<td>Distinct categories</td>
</tr>
</tbody></table>
</div></figure><pre><code class="hljs language-pgsql">
**Rules:** Grey = <span class="hljs-keyword">default</span>. Max <span class="hljs-number">6</span><span class="hljs-number">-7</span> colors. Attention colorblind (~<span class="hljs-number">8</span>% men).

Now we <span class="hljs-keyword">only</span> see a horizontal bar chart <span class="hljs-keyword">of</span> YoY growth <span class="hljs-keyword">by</span> genre. We use <span class="hljs-keyword">only</span> <span class="hljs-number">3</span> colors <span class="hljs-keyword">with</span> semantic meaning: red <span class="hljs-keyword">for</span> decline, grey <span class="hljs-keyword">for</span> moderate growth, green <span class="hljs-keyword">for</span> strong growth (&gt;<span class="hljs-number">15</span>%). Labels <span class="hljs-keyword">show</span> the delta <span class="hljs-keyword">with</span> sign. This demonstrates the principle &quot;grey = default, color only to highlight&quot;.

```python
# STRATEGIC COLOR: YoY Variation
r23 = df[df[<span class="hljs-string">&#x27;anno&#x27;</span>]==<span class="hljs-number">2023</span>].groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].sum()
r24 = df[df[<span class="hljs-string">&#x27;anno&#x27;</span>]==<span class="hljs-number">2024</span>].groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].sum()
yoy = ((r24-r23)/r23*<span class="hljs-number">100</span>).sort_values()
fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">6</span>))
cy = [<span class="hljs-string">&#x27;#e74c3c&#x27;</span> <span class="hljs-keyword">if</span> v&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#bdc3c7&#x27;</span> <span class="hljs-keyword">if</span> v&lt;<span class="hljs-number">15</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#27ae60&#x27;</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> yoy.<span class="hljs-keyword">values</span>]
bars = ax.barh(yoy.<span class="hljs-keyword">index</span>,yoy.<span class="hljs-keyword">values</span>,color=cy,height=<span class="hljs-number">0.6</span>)
ax.axvline(<span class="hljs-number">0</span>,color=<span class="hljs-string">&#x27;#2c3e50&#x27;</span>,linewidth=<span class="hljs-number">0.8</span>)
<span class="hljs-keyword">for</span> bar,val <span class="hljs-keyword">in</span> zip(bars,yoy.<span class="hljs-keyword">values</span>):
    ax.text(val+(<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> val&gt;=<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">-1</span>), bar.get_y()+bar.get_height()/<span class="hljs-number">2</span>,
            f<span class="hljs-string">&#x27;{val:+.1f}%&#x27;</span>,va=<span class="hljs-string">&#x27;center&#x27;</span>,ha=<span class="hljs-string">&#x27;left&#x27;</span> <span class="hljs-keyword">if</span> val&gt;=<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;right&#x27;</span>,fontsize=<span class="hljs-number">10</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,
            color=<span class="hljs-string">&#x27;#e74c3c&#x27;</span> <span class="hljs-keyword">if</span> val&lt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#27ae60&#x27;</span> <span class="hljs-keyword">if</span> val&gt;=<span class="hljs-number">15</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#7f8c8d&#x27;</span>)
ax.set_title(<span class="hljs-string">&#x27;YoY Growth: Fantasy explodes, Poetry declines&#x27;</span>,fontsize=<span class="hljs-number">13</span>,fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,loc=<span class="hljs-string">&#x27;left&#x27;</span>,pad=<span class="hljs-number">15</span>)
<span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;top&#x27;</span>,<span class="hljs-string">&#x27;right&#x27;</span>,<span class="hljs-string">&#x27;bottom&#x27;</span>,<span class="hljs-string">&#x27;left&#x27;</span>]: ax.spines[sp].set_visible(<span class="hljs-keyword">False</span>)
ax.xaxis.set_visible(<span class="hljs-keyword">False</span>); ax.tick_params(left=<span class="hljs-keyword">False</span>)
plt.tight_layout(); plt.<span class="hljs-keyword">show</span>()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-17.png" alt="Notebook output 17"></p>
<h2 id="small-multiples">Small Multiples</h2>
<blockquote>
<p><em>&quot;Small multiples are the most effective way to display complex data.&quot;</em> ‚Äî Edward Tufte. American statistician and sculptor.</p>
</blockquote>
<p>Small multiples place multiple charts side-by-side, identical in structure but different in data, allowing instant comparisons between categories. The temptation is to use <code>sharey=True</code> to make scales comparable, but when absolute volumes are very different (Thriller at 35k copies, Historical at 3k), the readability of all minor genres is sacrificed on the altar of comparability.</p>
<p><strong>The choice here is <code>sharey=False</code></strong>: each genre has its own Y-scale, because the goal is not to compare absolute volumes (already done in the bar chart in section 5.1) but to read the <strong>internal dynamics</strong> of each genre over time.</p>
<p>The <strong>6-month moving average</strong> filters seasonal noise and reveals the structural trend. The <strong>filled area</strong> shows raw monthly data as context; the <strong>dark line</strong> is the message. The <strong>% variation</strong> in the top right summarizes in a number what the eye already infers from the slope.</p>
<p><strong>Practical rule:</strong> in small multiples, choose <code>sharey=True</code> only if the comparison of absolute values is the main story. If the story is the trend, free each panel on its own scale.</p>
<pre><code class="hljs language-python"><span class="hljs-comment"># SMALL MULTIPLES: Trend by genre (fixed)</span>
t6 = df.groupby(<span class="hljs-string">&#x27;genere&#x27;</span>)[<span class="hljs-string">&#x27;ricavo&#x27;</span>].<span class="hljs-built_in">sum</span>().nlargest(<span class="hljs-number">6</span>).index
fig, axes = plt.subplots(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>), sharey=<span class="hljs-literal">False</span>, sharex=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># sharey=False!</span>

<span class="hljs-keyword">for</span> i, g <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(t6):
    ax = axes.flatten()[i]
    s = (df[df[<span class="hljs-string">&#x27;genere&#x27;</span>] == g]
         .groupby(<span class="hljs-string">&#x27;data&#x27;</span>)[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].<span class="hljs-built_in">sum</span>()
         .reset_index())
    s[<span class="hljs-string">&#x27;ma6&#x27;</span>] = s[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>].rolling(<span class="hljs-number">6</span>, center=<span class="hljs-literal">True</span>).mean()  <span class="hljs-comment"># 6 months, smoother</span>

    <span class="hljs-comment"># Area = raw data (context), line = smoothed trend (message)</span>
    ax.fill_between(s[<span class="hljs-string">&#x27;data&#x27;</span>], <span class="hljs-number">0</span>, s[<span class="hljs-string">&#x27;copie_vendute&#x27;</span>] / <span class="hljs-number">1000</span>,
                    alpha=<span class="hljs-number">0.12</span>, color=<span class="hljs-string">&#x27;#3498db&#x27;</span>, label=<span class="hljs-string">&#x27;Monthly&#x27;</span>)
    ax.plot(s[<span class="hljs-string">&#x27;data&#x27;</span>], s[<span class="hljs-string">&#x27;ma6&#x27;</span>] / <span class="hljs-number">1000</span>,
            color=<span class="hljs-string">&#x27;#2c3e50&#x27;</span>, linewidth=<span class="hljs-number">2.5</span>, label=<span class="hljs-string">&#x27;6m Average&#x27;</span>)

    <span class="hljs-comment"># % variation first vs last value of MA</span>
    ma_clean = s[<span class="hljs-string">&#x27;ma6&#x27;</span>].dropna()
    delta_pct = (ma_clean.iloc[-<span class="hljs-number">1</span>] - ma_clean.iloc[<span class="hljs-number">0</span>]) / ma_clean.iloc[<span class="hljs-number">0</span>] * <span class="hljs-number">100</span>
    color_delta = <span class="hljs-string">&#x27;#27ae60&#x27;</span> <span class="hljs-keyword">if</span> delta_pct &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;#e74c3c&#x27;</span>
    arrow = <span class="hljs-string">&#x27;‚ñ≤&#x27;</span> <span class="hljs-keyword">if</span> delta_pct &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;‚ñº&#x27;</span>

    ax.set_title(<span class="hljs-string">f&#x27;<span class="hljs-subst">{g}</span>&#x27;</span>, fontsize=<span class="hljs-number">12</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, loc=<span class="hljs-string">&#x27;left&#x27;</span>)
    ax.text(<span class="hljs-number">0.98</span>, <span class="hljs-number">0.95</span>, <span class="hljs-string">f&#x27;<span class="hljs-subst">{arrow}</span> <span class="hljs-subst">{<span class="hljs-built_in">abs</span>(delta_pct):<span class="hljs-number">.0</span>f}</span>%&#x27;</span>,
            transform=ax.transAxes, fontsize=<span class="hljs-number">11</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>,
            color=color_delta, ha=<span class="hljs-string">&#x27;right&#x27;</span>, va=<span class="hljs-string">&#x27;top&#x27;</span>)

    <span class="hljs-comment"># Y-axis with clear units</span>
    ax.set_ylabel(<span class="hljs-string">&#x27;Copies (k)&#x27;</span>, fontsize=<span class="hljs-number">8</span>)
    ax.spines[<span class="hljs-string">&#x27;top&#x27;</span>].set_visible(<span class="hljs-literal">False</span>)
    ax.spines[<span class="hljs-string">&#x27;right&#x27;</span>].set_visible(<span class="hljs-literal">False</span>)
    ax.xaxis.set_major_formatter(mdates.DateFormatter(<span class="hljs-string">&#x27;%b\n%y&#x27;</span>))
    ax.xaxis.set_major_locator(mdates.MonthLocator(interval=<span class="hljs-number">6</span>))
    ax.tick_params(labelsize=<span class="hljs-number">8</span>)

<span class="hljs-comment"># Unique legend at the top</span>
axes[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>].legend(fontsize=<span class="hljs-number">8</span>, loc=<span class="hljs-string">&#x27;upper left&#x27;</span>, frameon=<span class="hljs-literal">False</span>)

plt.suptitle(<span class="hljs-string">&#x27;Sales trend by genre ‚Äî % variation over the entire period&#x27;</span>,
             fontsize=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">&#x27;bold&#x27;</span>, y=<span class="hljs-number">1.02</span>)
plt.tight_layout()
plt.show()</code></pre><p><img src="../../../Assets/Notebook/generated/datavis_masterclass_parte1/datavis_masterclass_parte1-output-18.png" alt="Notebook output 18"></p>
<h2 id="in-the-next-notebook-parte-2">In the next notebook (Parte 2)</h2>
<ul>
<li><strong>When to use which chart</strong>: decision matrix based on communication objective</li>
<li><strong>Data transformation</strong>: normalization, log scale, indices, moving averages</li>
<li><strong>Advanced charts</strong>: Slope chart, Bump chart, Waffle, Dumbbell, Waterfall</li>
<li><strong>Dashboard design</strong>: how to compose multiple charts into a coherent view</li>
</ul>
<hr>
<p><em>&quot;The purpose of visualization is insight, not pictures.&quot;</em> ‚Äî Ben Shneiderman</p>
<blockquote>
<p>Source notebook: <a href="../../../Assets/Notebook/datavis_masterclass_parte1.ipynb">datavis_masterclass_parte1.ipynb</a></p>
</blockquote>
        </div>
      </section>
    </article>
  </main>
  <footer>
    <span data-it="¬© 2026 Mirko Calcaterra. Tutti i diritti riservati."
          data-en="¬© 2026 Mirko Calcaterra. All rights reserved.">
      ¬© 2026 Mirko Calcaterra. Tutti i diritti riservati.
    </span>
  </footer>
  <script>
    const BLOG_LANG_KEY = 'blogLang';
    const BLOG_THEME_KEY = 'blogTheme';
    const CURRENT_LANG = "en";
    const OTHER_LANG = "it";
    const OTHER_LANG_LINK = "../../../blog/it/datavis-masterclass-parte-1/index.html";
    (function() {
      const body = document.body;
      const themeToggle = document.querySelector('.theme-toggle');
      const themeThumb = document.querySelector('.theme-toggle .theme-thumb');
      const langBtn = document.querySelector('.lang-btn');
      const tocElement = document.querySelector('.post-toc');
      const tocToggle = tocElement ? tocElement.querySelector('.post-toc__toggle') : null;
      const tocToggleText = tocElement ? tocElement.querySelector('.post-toc__toggle-text') : null;
      const tocTitle = tocElement ? tocElement.querySelector('.post-toc__title') : null;
      const tocLinks = tocElement ? Array.from(tocElement.querySelectorAll('.post-toc__link')) : [];
      const headingEntries = tocLinks
        .map((link) => {
          const id = link.getAttribute('href').slice(1);
          const target = document.getElementById(id);
          return target ? { link, target } : null;
        })
        .filter(Boolean);
      const tocLabels = CURRENT_LANG === 'it'
        ? { title: 'Indice', show: 'Mostra indice', hide: 'Nascondi indice' }
        : { title: 'Table of contents', show: 'Show table of contents', hide: 'Hide table of contents' };
      const tableWrappers = Array.from(document.querySelectorAll('.table-wrapper[data-enhanced-table]'));
      const tableLabels = CURRENT_LANG === 'it'
        ? { expand: 'Apri a schermo intero', close: 'Chiudi' }
        : { expand: 'Open full view', close: 'Close' };
      const codeBlocks = Array.from(document.querySelectorAll('.post-body pre'));
      const codeCopyLabels = {
        it: { copy: 'Copia', copied: 'Copiato!' },
        en: { copy: 'Copy', copied: 'Copied!' },
      };
      let tableOverlay = null;
      let tableOverlayScroll = null;
      let tableOverlayClose = null;
      if (tocTitle) {
        tocTitle.textContent = tocLabels.title;
      }
      if (tocToggleText) {
        tocToggleText.textContent = tocLabels.title;
      }
      let tocCollapsed = false;
      let tocManualOverride = false;
      const tocMediaQuery = window.matchMedia ? window.matchMedia('(max-width: 1024px)') : null;
      function ensureTableOverlay() {
        if (tableOverlay) {
          return;
        }
        tableOverlay = document.createElement('div');
        tableOverlay.className = 'table-overlay';
        tableOverlay.innerHTML =
          '<div class="table-overlay__content">' +
          '<button type="button" class="table-overlay__close">' + tableLabels.close + '</button>' +
          '<div class="table-overlay__scroll"></div>' +
          '</div>';
        body.appendChild(tableOverlay);
        tableOverlayScroll = tableOverlay.querySelector('.table-overlay__scroll');
        tableOverlayClose = tableOverlay.querySelector('.table-overlay__close');
        if (tableOverlayClose) {
          tableOverlayClose.setAttribute('aria-label', tableLabels.close);
          tableOverlayClose.addEventListener('click', closeTableOverlay);
        }
        tableOverlay.addEventListener('click', (event) => {
          if (event.target === tableOverlay) {
            closeTableOverlay();
          }
        });
      }
      function closeTableOverlay() {
        if (!tableOverlay) {
          return;
        }
        tableOverlay.classList.remove('table-overlay--visible');
        body.classList.remove('no-scroll');
        if (tableOverlayScroll) {
          tableOverlayScroll.innerHTML = '';
        }
      }
      function openTableOverlay(wrapper) {
        ensureTableOverlay();
        if (!tableOverlay || !tableOverlayScroll) {
          return;
        }
        tableOverlayScroll.innerHTML = '';
        const table = wrapper.querySelector('table');
        if (table) {
          const clone = table.cloneNode(true);
          const tableSize = table.dataset.tableSize;
          if (tableSize) {
            clone.dataset.tableSize = tableSize;
          }
          tableOverlayScroll.appendChild(clone);
        }
        tableOverlay.classList.add('table-overlay--visible');
        body.classList.add('no-scroll');
        if (tableOverlayClose) {
          tableOverlayClose.focus();
        }
      }
      function enhanceTables() {
        if (!tableWrappers.length) {
          return;
        }
        tableWrappers.forEach((wrapper) => {
          if (wrapper.dataset.enhanced === 'true') {
            return;
          }
          const table = wrapper.querySelector('table');
          if (!table) {
            return;
          }
          const headerCells = table.querySelectorAll('thead th');
          const referenceCells = headerCells.length ? headerCells : table.querySelectorAll('tr:first-child > *');
          const columnCount = referenceCells.length;
          let tableSize = '';
          if (columnCount >= 6) {
            tableSize = 'wide';
          } else if (columnCount >= 4) {
            tableSize = 'medium';
          }
          if (tableSize) {
            wrapper.setAttribute('data-table-size', tableSize);
            table.dataset.tableSize = tableSize;
          }
          const expandBtn = document.createElement('button');
          expandBtn.type = 'button';
          expandBtn.className = 'table-wrapper__expand';
          expandBtn.innerHTML = '<span aria-hidden="true">üîç</span> ' + tableLabels.expand;
          expandBtn.setAttribute('aria-label', tableLabels.expand);
          expandBtn.addEventListener('click', () => openTableOverlay(wrapper));
          wrapper.appendChild(expandBtn);
          wrapper.dataset.enhanced = 'true';
        });
      }
      function fallbackCopy(text) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.setAttribute('readonly', '');
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        textarea.style.left = '-9999px';
        document.body.appendChild(textarea);
        textarea.select();
        let successful = false;
        try {
          successful = document.execCommand('copy');
        } catch (error) {
          successful = false;
        }
        textarea.remove();
        return successful;
      }
      function showCopyFeedback(button, labels) {
        if (button._copyTimeout) {
          clearTimeout(button._copyTimeout);
        }
        const labelEl = button.querySelector('.code-copy-btn__text');
        button.classList.add('code-copy-btn--copied');
        if (labelEl) {
          labelEl.textContent = labels.copied;
        }
        button._copyTimeout = window.setTimeout(() => {
          button.classList.remove('code-copy-btn--copied');
          if (labelEl) {
            labelEl.textContent = labels.copy;
          }
        }, 2000);
      }
      function enhanceCodeBlocks() {
        if (!codeBlocks.length) {
          return;
        }
        const labels = codeCopyLabels[CURRENT_LANG] || codeCopyLabels.en;
        codeBlocks.forEach((pre) => {
          if (pre.dataset.copyEnhanced === 'true') {
            return;
          }
          const code = pre.querySelector('code');
          if (!code) {
            return;
          }
          const button = document.createElement('button');
          button.type = 'button';
          button.className = 'code-copy-btn';
          button.setAttribute('aria-label', labels.copy);
          button.innerHTML =
            '<span class="code-copy-btn__icon" aria-hidden="true">üìã</span>' +
            '<span class="code-copy-btn__text">' + labels.copy + '</span>';
          button.addEventListener('click', async () => {
            const text = (code.textContent || '').replace(/s+$/, '');
            if (!text) {
              return;
            }
            let copied = false;
            if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
              try {
                await navigator.clipboard.writeText(text);
                copied = true;
              } catch (error) {
                copied = false;
              }
            }
            if (!copied) {
              copied = fallbackCopy(text);
            }
            if (copied) {
              showCopyFeedback(button, labels);
            }
          });
          pre.appendChild(button);
          pre.dataset.copyEnhanced = 'true';
        });
      }
      function setTocCollapsed(collapsed, { manual = false } = {}) {
        if (!tocElement) {
          return;
        }
        tocCollapsed = Boolean(collapsed);
        if (manual) {
          tocManualOverride = true;
        }
        tocElement.classList.toggle('post-toc--collapsed', tocCollapsed);
        tocElement.setAttribute('data-collapsed', tocCollapsed ? 'true' : 'false');
        if (tocToggle) {
          tocToggle.setAttribute('aria-expanded', tocCollapsed ? 'false' : 'true');
          tocToggle.setAttribute('aria-label', tocCollapsed ? tocLabels.show : tocLabels.hide);
        }
      }
      function initToc() {
        if (!tocElement) {
          return;
        }
        if (tocToggle) {
          tocToggle.addEventListener('click', () => {
            setTocCollapsed(!tocCollapsed, { manual: true });
          });
        }
        if (tocMediaQuery) {
          const handleMediaChange = (event) => {
            if (tocManualOverride) {
              return;
            }
            setTocCollapsed(event.matches);
          };
          if (typeof tocMediaQuery.addEventListener === 'function') {
            tocMediaQuery.addEventListener('change', handleMediaChange);
          } else if (typeof tocMediaQuery.addListener === 'function') {
            tocMediaQuery.addListener(handleMediaChange);
          }
          setTocCollapsed(tocMediaQuery.matches);
        } else {
          setTocCollapsed(false);
        }
      }
      const storedTheme = (localStorage.getItem(BLOG_THEME_KEY) || '').toLowerCase();
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const initialTheme = storedTheme === 'light' ? 'light' : (storedTheme === 'dark' ? 'dark' : (prefersDark ? 'dark' : 'light'));
      let activeLink = null;
      let ticking = false;
      function applyTheme(theme) {
        const resolved = theme === 'dark' ? 'dark' : 'light';
        body.setAttribute('data-theme', resolved);
        if (themeToggle) {
          themeToggle.classList.toggle('active', resolved === 'dark');
        }
        if (themeThumb) {
          themeThumb.textContent = resolved === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        }
        localStorage.setItem(BLOG_THEME_KEY, resolved);
      }
      function setActive(link) {
        if (activeLink === link) {
          return;
        }
        if (activeLink) {
          activeLink.classList.remove('post-toc__link--active');
        }
        if (link) {
          link.classList.add('post-toc__link--active');
        }
        activeLink = link;
      }
      function updateActiveHeading() {
        if (!headingEntries.length) {
          return;
        }
        const scrollPosition = window.scrollY + 160;
        let current = headingEntries[0];
        for (const item of headingEntries) {
          if (item.target.offsetTop <= scrollPosition) {
            current = item;
          } else {
            break;
          }
        }
        setActive(current.link);
      }
      function onScroll() {
        if (ticking) {
          return;
        }
        ticking = true;
        window.requestAnimationFrame(() => {
          updateActiveHeading();
          ticking = false;
        });
      }
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          closeTableOverlay();
        }
      });
      enhanceTables();
      enhanceCodeBlocks();
      initToc();
      applyTheme(initialTheme);
      if (themeToggle) {
        themeToggle.addEventListener('click', () => {
          applyTheme(body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
        });
      }
      if (langBtn) {
        langBtn.textContent = CURRENT_LANG === 'it' ? 'EN' : 'IT';
        if (OTHER_LANG_LINK) {
          langBtn.addEventListener('click', () => {
            localStorage.setItem(BLOG_LANG_KEY, OTHER_LANG);
            window.location.href = OTHER_LANG_LINK;
          });
        } else {
          langBtn.disabled = true;
          langBtn.classList.add('lang-btn--disabled');
        }
      }
      localStorage.setItem(BLOG_LANG_KEY, CURRENT_LANG);
      if (headingEntries.length) {
        headingEntries.sort((a, b) => a.target.offsetTop - b.target.offsetTop);
        updateActiveHeading();
        window.addEventListener('scroll', onScroll, { passive: true });
      }
    })();
  </script>
</body>
</html>